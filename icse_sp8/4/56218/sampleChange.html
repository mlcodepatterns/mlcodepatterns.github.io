<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    
    last_day = datetime.datetime.utcnow() - datetime.timedelta(days=1)
    
    <a id="change">return {
        &quotfeed_errors&quot: MFeedFetchHistory.objects(fetch_date__gte=last_day, status_code__nin=[200, 304]).count(),
        &quotfeed_success&quot: MFeedFetchHistory.objects(fetch_date__gte=last_day, status_code__in=[200, 304]).count(),
        &quotpage_errors&quot: MPageFetchHistory.objects(fetch_date__gte=last_day, status_code__nin=[200, 304]).count(),
        &quotpage_success&quot: MPageFetchHistory.objects(fetch_date__gte=last_day, status_code__in=[200, 304]).count(),
    }</a>

if __name__ == &quot__main__&quot:
    MuninGraph(graph_config, calculate_metrics).run()
</code></pre><h3>After Change</h3><pre><code class='java'>
    from apps.statistics.models import MStatistics
    statistics = MStatistics.all()
    
    <a id="change">return {
        &quotfeed_success&quot: statistics[&quotfeeds_fetched&quot]
    }</a>

if __name__ == &quot__main__&quot:
    MuninGraph(graph_config, calculate_metrics).run()
</code></pre>