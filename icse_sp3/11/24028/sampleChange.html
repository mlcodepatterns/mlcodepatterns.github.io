<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    ddata[&quotxroot&quot] = ddata[&quotX&quot][ddata[&quotiroot&quot]] 
    &#47&#47 annotate rows of X with Moignard et al. (2015) experimental cell groups
    groups_names = [&quotHF&quot, &quotNP&quot, &quotPS&quot, &quot4SG&quot, &quot4SFG&quot]
    <a id="change">groups = []</a> &#47&#47 a list with n entries (one for each sample)
    for name in cellnames:
        <a id="change">for groupname in groups_names:
            if name.startswith(groupname):
                groups.append(groupname)
    &#47&#47 groups are categorical annotation for rows of X
   </a> ddata[&quotrowcat&quot] = {&quotgroups&quot: groups}
    &#47&#47 add additional metadata for the groups, we want them to be ordered
    &#47&#47 and we want custom colors for each group
    ddata[&quotgroups_names&quot] = groups_names    </code></pre><h3>After Change</h3><pre><code class='java'>
    adata[&quotgroups_names&quot] = groups_names = [&quotHF&quot, &quotNP&quot, &quotPS&quot, &quot4SG&quot, &quot4SFG&quot]
    adata[&quotgroups_colors&quot] = [&quot&#47&#47D7A83E&quot, &quot&#47&#477AAE5D&quot, &quot&#47&#47497ABC&quot, &quot&#47&#47AF353A&quot, &quot&#47&#47765099&quot]
    &#47&#47 get name for each cell
    <a id="change">adata.smp[&quotgroups&quot] = [
        next(gname for gname in groups_names if sname.startswith(gname))
        for sname in adata.smp_names]</a>
    return adata

def moignard15_dpt(ddpt):
    &#47&#47 switch on annotation by uncommenting the following</code></pre>