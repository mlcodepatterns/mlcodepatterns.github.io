<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            &quottime&quot: datetime.datetime.now()
        }
        QA_SU_save_backtest_message(_backtest_mes, self.setting.client)
        <a id="change">QA_SU_save_account_message(__messages, self.setting.client)</a>
        QA_SU_save_account_to_csv(__messages)
        &#47&#47 QA.QA_SU_save_backtest_message(analysis_message, self.setting.client)

    def QA_backtest_excute_bid(self, __result,  __date, __hold, __code, __amount):</code></pre><h3>After Change</h3><pre><code class='java'>
        self.__benchmark_data = QA_fetch_index_day(
            self.benchmark_code, self.start_real_date,
            self.end_real_date)
        <a id="change">if len(self.__messages)&gt;1:
            performace = QA_backtest_analysis_start(
                self.setting.client, self.strategy_stock_list,self.__messages,
                self.trade_list[self.start_real_id:self.end_real_id + 1],
                self.market_data, self.__benchmark_data)
            _backtest_mes = {
                &quotuser&quot: self.setting.QA_setting_user_name,
                &quotstrategy&quot: self.strategy_name,
                &quotstock_list&quot: performace[&quotcode&quot],
                &quotstart_time&quot: self.strategy_start_date,
                &quotend_time&quot: self.strategy_end_date,
                &quotaccount_cookie&quot: self.account.account_cookie,
                &quotannualized_returns&quot: performace[&quotannualized_returns&quot],
                &quotbenchmark_annualized_returns&quot: performace[&quotbenchmark_annualized_returns&quot],
                &quotassets&quot: performace[&quotassets&quot],
                &quotbenchmark_assets&quot: performace[&quotbenchmark_assets&quot],
                &quottrade_date&quot: performace[&quottrade_date&quot],
                &quottotal_date&quot: performace[&quottotal_date&quot],
                &quotwin_rate&quot: performace[&quotwin_rate&quot],
                &quotalpha&quot: performace[&quotalpha&quot],
                &quotbeta&quot: performace[&quotbeta&quot],
                &quotsharpe&quot: performace[&quotsharpe&quot],
                &quotvol&quot: performace[&quotvol&quot],
                &quotbenchmark_vol&quot: performace[&quotbenchmark_vol&quot],
                &quotmax_drop&quot: performace[&quotmax_drop&quot],
                &quotexist&quot: __exist_time,
                &quottime&quot: datetime.datetime.now()
            }
            QA_SU_save_backtest_message(_backtest_mes, self.setting.client)
            QA_SU_save_account_message(self.__messages, self.setting.client)
            QA_SU_save_account_to_csv(self.__messages)
        &#47&#47 QA.QA_SU_save_backtest_message(analysis_message, self.setting.client)

   </a> def QA_backtest_excute_bid(self, __result,  __date, __hold, __code, __amount):
        
        这里是处理报价的逻辑部分
        2017/7/19 修改</code></pre>