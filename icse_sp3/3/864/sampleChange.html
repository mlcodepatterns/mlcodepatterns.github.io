<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

    if hidden is None:
      return {
          &quotmemory&quot: cuda(<a id="change">T</a>.zeros(b, m, w).fill_(δ), gpu_id=self.gpu_id),
          &quotlink_matrix&quot: cuda(T.zeros(b, 1, m, m), gpu_id=self.gpu_id),
          &quotprecedence&quot: cuda(T.zeros(b, 1, m), gpu_id=self.gpu_id),
          &quotread_weights&quot: cuda(T.zeros(b, r, m).fill_(δ), gpu_id=self.gpu_id),</code></pre><h3>After Change</h3><pre><code class='java'>
          &quotusage_vector&quot: cuda(T.zeros(b, m), gpu_id=self.gpu_id)
      }
      &#47&#47 Build FLANN randomized k-d tree indexes for each batch
      <a id="change">hx = rebuild_indexes(hx)</a>
    else:
      &#47&#47 hidden[&quotmemory&quot] = hidden[&quotmemory&quot].clone()
      hidden[&quotlink_matrix&quot] = hidden[&quotlink_matrix&quot].clone()
      hidden[&quotprecedence&quot] = hidden[&quotprecedence&quot].clone()</code></pre>