<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            columns to be merged on.  The values from df1 are the ones which
            are retained for any shared, non-merging columns.
    
    <a id="change">if year_col not in df1.columns:
        assert date_col in df1.columns
        assert date_col not in df2.columns
        df1[year_col] = pd.to_datetime(df1[date_col]).dt.year

   </a> if year_col not in df2.columns:
        assert date_col in df2.columns
        assert date_col not in df1.columns
        df2[year_col] = pd.to_datetime(df2[date_col]).dt.year</code></pre><h3>After Change</h3><pre><code class='java'>
    &#47&#47 assert df_date[date_col] is a Date
    &#47&#47 assert df_year[year_col] is a Date
    df_date = df_date.copy()
    <a id="change">df_year = df_year.copy()</a>

    df_date[&quottmp_year&quot] = pd.to_datetime(df_date[date_col]).dt.year
    df_year[&quottmp_year&quot] = pd.to_datetime(df_year[year_col]).dt.year
</code></pre>