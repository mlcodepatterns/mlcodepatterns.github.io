<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    var_count = X[i].shape[-1]
    X_train[i, :, :var_count] = X[i]

X_train = <a id="change">(X_train - X_train.mean(axis=0))</a> / (<a id="change">X_train.std(axis=0)</a> + 1e-8)

&quot&quot&quot Load test set &quot&quot&quot
</code></pre><h3>After Change</h3><pre><code class='java'>
print(&quotmax number variables : &quot, max_nb_variables)
print(&quotmin number variables : &quot, min_nb_variables)

<a id="change">X_train</a> = np.zeros((X.shape[0], X[0].shape[0], max_nb_variables))
y_train = y_data[(np.array(trainind)-1)] &#47&#47&#47&#47&#47&#47Train Labels

&#47&#47 pad ending with zeros to get numpy arrays
for i in range(X_train.shape[0]):
    var_count = X[i].shape[-1]
    X_train[i, :, :var_count] = X[i]

<a id="change">X_train_mean = X_train.mean()</a>
<a id="change">X_train_std = X_train.std()</a>
print("Train Mean +- std : ", X_train_mean, X_train_std)
X_train = <a id="change">(X_train - X_train_mean)</a> / <a id="change">(X_train_std + 1e-8)</a>

&quot&quot&quot Load test set &quot&quot&quot

X = X_data[(np.array(testind)-1)] &#47&#47&#47&#47&#47&#47&#47&#47Test Data

X_test = np.zeros((X.shape[0], X[0].shape[0], max_nb_variables))
y_test = y_data[(np.array(testind)-1)] &#47&#47&#47&#47&#47&#47&#47&#47Test Labelsâ€‹

&#47&#47 pad ending with zeros to get numpy arrays
for i in range(X_test.shape[0]):
    var_count = X[i].shape[-1]
    X_test[i, :, :var_count] = X[i]

X_test = <a id="change">(X_test - X_train_mean)</a> / <a id="change">(X_train_std + 1e-8)</a>

&quot&quot&quot Save the datasets &quot&quot&quot
print("Train dataset : ", X_train.shape, y_train.shape)
print("Test dataset : ", X_test.shape, y_test.shape)</code></pre>