<html><h3>f5665c4258e60c7e93b3cac79bebefd5906af6fd,doc/examples/syn_registration_3d.py,,,#,48
</h3><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

warped, affine_init = affine_registration(nib_static, nib_moving)
static = nib_static.get_data().squeeze().astype(np.float32)
<a id="change">moving = warped.get_data().squeeze().astype(np.float32)</a>

def renormalize_image(image):
    m=np.min(image)
    M=np.max(image)</code></pre><h3>After Change</h3><pre><code class='java'>
the pyramid. The 0-th level corresponds to the finest resolution.  


opt_iter = <a id="change">[5, 10, 10]</a>
registration_optimizer = SymmetricDiffeomorphicRegistration(metric, opt_iter)


Execute the optimization, which returns a DiffeomorphicMap object,
that can be used to register images back and forth between the static and moving
domains


<a id="change">mapping = registration_optimizer.optimize(static, moving, 
                                          static_affine, moving_affine, pre_align)</a>


Now let&quots warp the moving image and see if it gets similar to the static image


warped_moving = mapping.transform(moving)


To visually check the overlap of the static image with the transformed moving
image, we can plot them on top of each other with different channels to see
where the differences are located


overlay_middle_slices_coronal(static, warped_moving, &quotStatic&quot, &quotWarped moving&quot, &quotwarped_moving.png&quot)


.. figure:: warped_moving.png
    :align: center

**Moving image transformed under the (direct) transformation in green
on top of the static image (in red)**.



And we can also apply the inverse mapping to verify that the warped static image
is similar to the moving image 


<a id="change">warped_static = mapping.transform_inverse(static)</a>

overlay_middle_slices_coronal(warped_static, moving, &quotWarped static&quot, &quotMoving&quot, &quotwarped_static.png&quot)

</code></pre><img src="65096544.png" alt="Italian Trulli"   style="width:500px;height:500px;"><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/nipy/dipy/commit/f5665c4258e60c7e93b3cac79bebefd5906af6fd#diff-eac1d690fdcc51247fbdb669ec580c1e294ae86bcdfdec4b19b32687ad918dc3L48' target='_blank'>Link</a></div><div id='project'> Project Name: nipy/dipy</div><div id='commit'> Commit Name: f5665c4258e60c7e93b3cac79bebefd5906af6fd</div><div id='time'> Time: 2014-04-13</div><div id='author'> Author: jomaroceguedag@gmail.com</div><div id='file'> File Name: doc/examples/syn_registration_3d.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: </div><BR><BR><div id='link'><a href='https://github.com/tensorflow/models/commit/90f63a1e1653bfa17fde8260a4aa20231b269b7d#diff-c3a04be9a813d29df4cd159476e4586bfce9752d9a03a0c2a00a66fbd35c8c36L263' target='_blank'>Link</a></div><div id='project'> Project Name: tensorflow/models</div><div id='commit'> Commit Name: 90f63a1e1653bfa17fde8260a4aa20231b269b7d</div><div id='time'> Time: 2017-06-29</div><div id='author'> Author: alexleegk@gmail.com</div><div id='file'> File Name: video_prediction/prediction_model.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: cdna_transformation</div><BR><BR><div id='link'><a href='https://github.com/tensorflow/tpu/commit/11b0078497d44560e1528343b6744451b3400928#diff-717b553873e416ca728cb8321488e4a92bfa7dc393bd0d7a2f650c5f4d70f3aaL145' target='_blank'>Link</a></div><div id='project'> Project Name: tensorflow/tpu</div><div id='commit'> Commit Name: 11b0078497d44560e1528343b6744451b3400928</div><div id='time'> Time: 2019-11-01</div><div id='author'> Author: pengchong@google.com</div><div id='file'> File Name: models/official/detection/dataloader/maskrcnn_parser.py</div><div id='class'> Class Name: Parser</div><div id='method'> Method Name: _parse_train_data</div><BR><BR><div id='link'><a href='https://github.com/tensorflow/models/commit/e12bd6a5e5195e158384059da3d5d47638ba12a1#diff-979c0874574a84c17305bec3f03f60aa69b3332579745e4c16d75d0f85e43cadL145' target='_blank'>Link</a></div><div id='project'> Project Name: tensorflow/models</div><div id='commit'> Commit Name: e12bd6a5e5195e158384059da3d5d47638ba12a1</div><div id='time'> Time: 2019-11-01</div><div id='author'> Author: pengchong@google.com</div><div id='file'> File Name: official/vision/detection/dataloader/maskrcnn_parser.py</div><div id='class'> Class Name: Parser</div><div id='method'> Method Name: _parse_train_data</div><BR>