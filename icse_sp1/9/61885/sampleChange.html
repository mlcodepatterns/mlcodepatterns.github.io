<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        assert(input1.is_contiguous() == True)
        assert(input2.is_contiguous() == True)

        <a id="change">with torch.cuda.device_of(input1):
            rbot1 = input1.new()
            rbot2 = input2.new()
            output = input1.new()

            correlation.Correlation_forward_cuda(input1, input2, rbot1, rbot2, output, 
                self.pad_size, self.kernel_size, self.max_displacement,self.stride1, self.stride2, self.corr_multiply)

       </a> return output

    def backward(self, grad_output):
        input1, input2 = self.saved_tensors</code></pre><h3>After Change</h3><pre><code class='java'>
    def forward(ctx,
                input1,
                input2,
                pad<a id="change">_</a>size=3,
                kernel_size=3,
                max_displacement=20,
                stride1=1,</code></pre>