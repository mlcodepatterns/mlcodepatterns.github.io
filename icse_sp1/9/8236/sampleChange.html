<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            &#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47
            &#47&#47 1- Count the dstips and store them
            &#47&#47 TODO: Retire this info after we finish 2-. Because its duplicated
            <a id="change">self.outputqueue.put(&quot05|database|[DB]: Add_ips called with profileid {}, twid {}, daddr {}&quot.format(profileid, twid, str(daddr)))</a>
            &#47&#47 Get the hash of the timewindow
            hash_id = profileid + self.separator + twid
            &#47&#47 Get the DstIPs data for this tw in this profile
            &#47&#47 The format is data[&quot1.1.1.1&quot] = 3</code></pre><h3>After Change</h3><pre><code class='java'>
            prev_data = self.getDataFromProfileTW(profileid, twid, type_host_key, summaryState, proto, role, &quotIPs&quot)
            try:
                innerdata = prev_data[str(ip_as_obj)]
                <a id="change">self.print(&quotadd_ips(): Adding for dst port {}. PRE Data: {}&quot.format(dport, innerdata), 0, 3)</a>
                &#47&#47 We had this port
                &#47&#47 We need to add all the data
                innerdata[&quottotalflows&quot] += 1
                innerdata[&quottotalpkt&quot] += int(pkts)</code></pre>