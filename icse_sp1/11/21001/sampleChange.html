<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

    def test_correlations_narrow_v1_vs_v5(self):
        T = np.random.randint(10, 100)
        D = <a id="change">np</a>.random.randint(2, 8)
        K = <a id="change">np</a>.random.randint(3, 5)
        <a id="change">delay = np.random.randint(0, 2)</a>
        Y = <a id="change">np</a>.random.normal(size=(D, T)) + 1j * <a id="change">np</a>.random.normal(size=(D, T))

        inverse_power = wpe.get_power_inverse(Y)
        R, r = wpe.get_correlations_narrow(Y, inverse_power, K, delay)
        <a id="change">R_v5, r_v5 = wpe.get_correlations_narrow_v5(Y, inverse_power, K, delay)</a>

        tc.assert_allclose(R_v5, R)
        tc.assert_allclose(r_v5, r)
</code></pre><h3>After Change</h3><pre><code class='java'>
        R_desired, r_desired = wpe.get_correlations_narrow(
            self.Y, inverse_power, self.K, self.delay
        )
        <a id="change">R_actual</a>, r_actual = wpe.get_correlations_narrow_v5(
            self.Y, inverse_power, self.K, self.delay
        )
        tc.assert_allclose(R_actual, R_desired)</code></pre>