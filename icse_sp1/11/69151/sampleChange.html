<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    assert np.abs(density[0,2] - 2.0/6.0) &lt; 0.0001

def test_density_weights(array, stack):
    <a id="change">atomic_weights = np.array([1, 1, 1, 1, 1, 0.5])</a>

    &#47&#47 weights should be applied correctly
    density, (x, y, z) = struc.density(array, weights=atomic_weights)
    assert density.sum() == 5.5</code></pre><h3>After Change</h3><pre><code class='java'>

def test_density_weights(array, stack):
    &#47&#47 assign weights to coordinates
    <a id="change">atomic_weights = np.arange(0.1, 0.7, 0.1)</a>

    &#47&#47 weights should be applied correctly
    density, (x, y, z) = struc.density(array, weights=atomic_weights)
    assert density.sum() == atomic_weights.sum()</code></pre>