<html><h3>2d05fc8af6533babd8b5ebc44149758c6b2535e7,official/benchmark/retinanet_benchmark.py,RetinanetBenchmarkReal,benchmark_8_gpu_coco,#RetinanetBenchmarkReal#,226
</h3><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
  @flagsaver.flagsaver
  def benchmark_8_gpu_coco(self):
    Run RetinaNet model accuracy test with 8 GPUs.
    <a id="change">self.num_gpus = 8</a>
    self._setup()
    params = <a id="change">copy.deepcopy(self.params_override)</a>
    params[&quottrain&quot][&quottotal_steps&quot] = 1875  &#47&#47 One epoch.
    &#47&#47 The iterations_per_loop must be one, otherwise the number of examples per
    &#47&#47 second would be wrong. Currently only support calling callback per batch
    &#47&#47 when each loop only runs on one batch, i.e. host loop for one step. The
    &#47&#47 performance of this situation might be lower than the case of
    &#47&#47 iterations_per_loop &gt; 1.
    &#47&#47 Related bug: b/135933080
    params[&quottrain&quot][&quotiterations_per_loop&quot] = 1
    params[&quoteval&quot][&quoteval_samples&quot] = 8
    <a id="change">FLAGS.num_gpus</a> = <a id="change">self.num_gpus</a>
    <a id="change">FLAGS.params_override = json.dumps(params)</a>
    FLAGS.model_dir = self._get_model_dir(&quotreal_benchmark_8_gpu_coco&quot)
    &#47&#47 Use negative value to avoid saving checkpoints.
    <a id="change">FLAGS.save_checkpoint_freq</a> = <a id="change">-1</a>
    <a id="change">if self.timer_callback is None:
      logging.error(&quotCannot measure performance without timer callback&quot)
    else:
      self._run_and_report_benchmark()

 </a> @flagsaver.flagsaver
  def benchmark_1_gpu_coco(self):
    Run RetinaNet model accuracy test with 1 GPU.
    self.num_gpus = 1</code></pre><h3>After Change</h3><pre><code class='java'>
  def benchmark_8_gpu_coco(self):
    Run RetinaNet model accuracy test with 8 GPUs.
    self._setup()
    params = <a id="change">self._params()</a>
    params[&quottrain&quot][&quottotal_steps&quot] = 1875  &#47&#47 One epoch.
    &#47&#47 The iterations_per_loop must be one, otherwise the number of examples per
    &#47&#47 second would be wrong. Currently only support calling callback per batch
    &#47&#47 when each loop only runs on one batch, i.e. host loop for one step. The
    &#47&#47 performance of this situation might be lower than the case of
    &#47&#47 iterations_per_loop &gt; 1.
    &#47&#47 Related bug: b/135933080
    params[&quottrain&quot][&quotiterations_per_loop&quot] = 1
    params[&quoteval&quot][&quoteval_samples&quot] = 8
    FLAGS.num_gpus = 8
    FLAGS.model_dir = self._get_model_dir(&quotreal_benchmark_8_gpu_coco&quot)
    FLAGS.strategy_type = &quotmirrored&quot
    <a id="change">self._run_and_report_benchmark(params)</a>

  @flagsaver.flagsaver
  def benchmark_1_gpu_coco(self):
    Run RetinaNet model accuracy test with 1 GPU.</code></pre><img src="328698541.png" alt="Italian Trulli"   style="width:500px;height:500px;"><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 21</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/tensorflow/models/commit/2d05fc8af6533babd8b5ebc44149758c6b2535e7#diff-742471e69d59262e52c9e0c47791c49a98482d4b1895666daeb47d61d0982ebfL224' target='_blank'>Link</a></div><div id='project'> Project Name: tensorflow/models</div><div id='commit'> Commit Name: 2d05fc8af6533babd8b5ebc44149758c6b2535e7</div><div id='time'> Time: 2020-04-22</div><div id='author'> Author: jbaiocchi@google.com</div><div id='file'> File Name: official/benchmark/retinanet_benchmark.py</div><div id='class'> Class Name: RetinanetBenchmarkReal</div><div id='method'> Method Name: benchmark_8_gpu_coco</div><BR><BR><div id='link'><a href='https://github.com/tensorflow/models/commit/2d05fc8af6533babd8b5ebc44149758c6b2535e7#diff-742471e69d59262e52c9e0c47791c49a98482d4b1895666daeb47d61d0982ebfL272' target='_blank'>Link</a></div><div id='project'> Project Name: tensorflow/models</div><div id='commit'> Commit Name: 2d05fc8af6533babd8b5ebc44149758c6b2535e7</div><div id='time'> Time: 2020-04-22</div><div id='author'> Author: jbaiocchi@google.com</div><div id='file'> File Name: official/benchmark/retinanet_benchmark.py</div><div id='class'> Class Name: RetinanetBenchmarkReal</div><div id='method'> Method Name: benchmark_xla_1_gpu_coco</div><BR><BR><div id='link'><a href='https://github.com/tensorflow/models/commit/2d05fc8af6533babd8b5ebc44149758c6b2535e7#diff-742471e69d59262e52c9e0c47791c49a98482d4b1895666daeb47d61d0982ebfL226' target='_blank'>Link</a></div><div id='project'> Project Name: tensorflow/models</div><div id='commit'> Commit Name: 2d05fc8af6533babd8b5ebc44149758c6b2535e7</div><div id='time'> Time: 2020-04-22</div><div id='author'> Author: jbaiocchi@google.com</div><div id='file'> File Name: official/benchmark/retinanet_benchmark.py</div><div id='class'> Class Name: RetinanetBenchmarkReal</div><div id='method'> Method Name: benchmark_8_gpu_coco</div><BR><BR><div id='link'><a href='https://github.com/tensorflow/models/commit/2d05fc8af6533babd8b5ebc44149758c6b2535e7#diff-742471e69d59262e52c9e0c47791c49a98482d4b1895666daeb47d61d0982ebfL251' target='_blank'>Link</a></div><div id='project'> Project Name: tensorflow/models</div><div id='commit'> Commit Name: 2d05fc8af6533babd8b5ebc44149758c6b2535e7</div><div id='time'> Time: 2020-04-22</div><div id='author'> Author: jbaiocchi@google.com</div><div id='file'> File Name: official/benchmark/retinanet_benchmark.py</div><div id='class'> Class Name: RetinanetBenchmarkReal</div><div id='method'> Method Name: benchmark_1_gpu_coco</div><BR>