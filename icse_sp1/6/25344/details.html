<html><h3>4bf3f166cbb0361bed0be994bbaeee5e77b03029,perfkitbenchmarker/linux_benchmarks/dpb_sparksql_benchmark.py,,Prepare,#Any#,130
</h3><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
  if FLAGS.dpb_sparksql_data:
    stdout = storage_service.List(FLAGS.dpb_sparksql_data)

    <a id="change">for table_dir in stdout.split(&quot\n&quot):
      &#47&#47 The directory name is the table name.
      if not table_dir:
        continue
      table = re.split(&quot |/&quot, table_dir.rstrip(&quot/&quot)).pop()
      stats = dpb_service_instance.SubmitJob(
          pyspark_file=os.path.join(benchmark_spec.base_dir,
                                    SPARK_TABLE_SCRIPT),
          job_type=BaseDpbService.PYSPARK_JOB_TYPE,
          job_arguments=[FLAGS.dpb_sparksql_data, table])
      logging.info(stats)
      if not stats[&quotsuccess&quot]:
        raise errors.Benchmarks.PrepareException(
            &quotCreates table {} from {} failed&quot.format(table, table_dir))


</a>def Run(benchmark_spec):
  Runs a sequence of Spark SQL Query.

  Args:</code></pre><h3>After Change</h3><pre><code class='java'>
    stdout = storage_service.List(FLAGS.dpb_sparksql_data)

    table_subdirs = [re.split(&quot |/&quot, line.rstrip(&quot/&quot)).pop()
                     <a id="change">for</a> line in stdout.split(&quot\n&quot) if line]
    stats = dpb_service_instance.SubmitJob(
        pyspark_file=os.path.join(benchmark_spec.base_dir,
                                  SPARK_TABLE_SCRIPT),
        job_type=BaseDpbService.PYSPARK_JOB_TYPE,
        job_arguments=[FLAGS.dpb_sparksql_data + <a id="change">&quot,&quot.join(table_subdirs)</a>])
    logging.info(stats)
    if not stats[&quotsuccess&quot]:
      raise errors.Benchmarks.PrepareException(</code></pre><img src="131985502.png" alt="Italian Trulli"   style="width:500px;height:500px;"><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/GoogleCloudPlatform/PerfKitBenchmarker/commit/4bf3f166cbb0361bed0be994bbaeee5e77b03029#diff-732d429e6c52ba595b03ddf4945d5b9ad61f508a6e68599b6e67372fc7f743deL169' target='_blank'>Link</a></div><div id='project'> Project Name: GoogleCloudPlatform/PerfKitBenchmarker</div><div id='commit'> Commit Name: 4bf3f166cbb0361bed0be994bbaeee5e77b03029</div><div id='time'> Time: 2020-04-30</div><div id='author'> Author: pclay@google.com</div><div id='file'> File Name: perfkitbenchmarker/linux_benchmarks/dpb_sparksql_benchmark.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: Prepare</div><BR><BR><div id='link'><a href='https://github.com/deepgram/kur/commit/a89d7dd73bf376f74264512e2a22d8b55b103853#diff-9cf419b240430d6c470fb79e27ddaed17581d2ff4f26f697fcb58b14171ce2d3L213' target='_blank'>Link</a></div><div id='project'> Project Name: deepgram/kur</div><div id='commit'> Commit Name: a89d7dd73bf376f74264512e2a22d8b55b103853</div><div id='time'> Time: 2017-04-10</div><div id='author'> Author: ajsyp@syptech.net</div><div id='file'> File Name: kur/loggers/binary_logger.py</div><div id='class'> Class Name: BinaryLogger</div><div id='method'> Method Name: enumerate_statistics</div><BR><BR><div id='link'><a href='https://github.com/CellProfiler/CellProfiler/commit/fe6d70a51d1a575313906708cf4bcda767b11d07#diff-5f77f984644abe156cc558738d3f4265b89cb423ede718aa9d5f0579edc63fd7L389' target='_blank'>Link</a></div><div id='project'> Project Name: CellProfiler/CellProfiler</div><div id='commit'> Commit Name: fe6d70a51d1a575313906708cf4bcda767b11d07</div><div id='time'> Time: 2010-09-20</div><div id='author'> Author: leek@1fc53939-2000-0410-845c-e8453a809027</div><div id='file'> File Name: cellprofiler/measurements.py</div><div id='class'> Class Name: Measurements</div><div id='method'> Method Name: apply_metadata</div><BR><BR><div id='link'><a href='https://github.com/kwgoodman/numerox/commit/d9444f0c2966113ed8dcd075e64e32645e9ec21d#diff-6a776881d6af14f3c2c2df3ef6050b410723acf995a9fb2b538c72eb2bbd0f09L57' target='_blank'>Link</a></div><div id='project'> Project Name: kwgoodman/numerox</div><div id='commit'> Commit Name: d9444f0c2966113ed8dcd075e64e32645e9ec21d</div><div id='time'> Time: 2017-11-04</div><div id='author'> Author: kwgoodman@gmail.com</div><div id='file'> File Name: numerox/prediction.py</div><div id='class'> Class Name: Prediction</div><div id='method'> Method Name: performance</div><BR>