<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

            assert len(make_secondary_time_index) == 1, "Can only provide 1 secondary time index"
            secondary_time_index = make_secondary_time_index.keys()[0]
            secondary_variables = [index, secondary_time_index] + <a id="change">make_secondary_time_index</a>.values()[0]
            secondary_df = new_entity_df. \
                drop_duplicates(index, keep=&quotlast&quot)[secondary_variables]
            if new_entity_secondary_time_index:
                secondary_df.rename(columns={secondary_time_index: new_entity_secondary_time_index},
                                    inplace=True)
            else:
                new_entity_secondary_time_index = secondary_time_index
            secondary_df.set_index(index, inplace=True)
            new_entity_df = new_entity_df2.join(secondary_df, on=index)
        else:
            new_entity_df = new_entity_df2

        base_entity_index = index
        if convert_links_to_integers:
            old_entity_df = self.get_dataframe(base_entity_id)
            link_variable_id = self.make_index_variable_name(new_entity_id)
            new_entity_df[link_variable_id] = np.arange(0, new_entity_df.shape[0])
            just_index = old_entity_df[[index]]
            id_as_int = just_index.merge(new_entity_df,
                                         left_on=index,
                                         right_on=index,
                                         how=&quotleft&quot)[link_variable_id]

            <a id="change">old_entity_df.loc[:, index]</a> = id_as_int.values

            base_entity.update_data(old_entity_df)
            index = link_variable_id</code></pre><h3>After Change</h3><pre><code class='java'>
            time_index_reduce = &quotfirst&quot

            assert len(make_secondary_time_index) == 1, "Can only provide 1 secondary time index"
            secondary_time_index = <a id="change">list</a>(make_secondary_time_index.keys())[0]
            secondary_variables = [index, secondary_time_index] + <a id="change">list</a>(<a id="change">make_secondary_time_index.values()</a>)[0]
            secondary_df = new_entity_df. \
                drop_duplicates(index, keep=&quotlast&quot)[secondary_variables]
            if new_entity_secondary_time_index:
                secondary_df.rename(columns={secondary_time_index: new_entity_secondary_time_index},
                                    inplace=True)
            else:
                new_entity_secondary_time_index = secondary_time_index
            secondary_df.set_index(index, inplace=True)
            new_entity_df = new_entity_df2.join(secondary_df, on=index)
        else:
            new_entity_df = new_entity_df2

        base_entity_index = index
        if convert_links_to_integers:
            old_entity_df = self.get_dataframe(base_entity_id)
            link_variable_id = self.make_index_variable_name(new_entity_id)
            new_entity_df[link_variable_id] = np.arange(0, new_entity_df.shape[0])
            just_index = old_entity_df[[index]]
            id_as_int = just_index.merge(new_entity_df,
                                         left_on=index,
                                         right_on=index,
                                         how=&quotleft&quot)[link_variable_id]

            <a id="change">old_entity_df.loc[:, index]</a> = id_as_int.values

            base_entity.update_data(old_entity_df)
            index = link_variable_id</code></pre>