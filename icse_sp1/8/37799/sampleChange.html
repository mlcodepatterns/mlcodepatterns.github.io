<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        logger.info("Sorting by estimated face yaw angle..")
        filename_list, _, landmarks = self._get_landmarks()

        <a id="change">logger.info("Estimating yaw...")</a>
        yaws = [self.calc_landmarks_face_yaw(mark) for mark in landmarks]

        logger.info("Sorting...")
        matched_list = list(zip(filename_list, yaws))</code></pre><h3>After Change</h3><pre><code class='java'>
         Sort by estimated face yaw angle 
        logger.info("Sorting by estimated face yaw angle..")
        self._loader = FacesLoader(self._args.input_dir)  &#47&#47 TODO This should be set in init
        <a id="change">filenames = []</a>
        yaws = []
        for filename, image, metadata in tqdm(self._loader.load(),
                                              desc="Classifying Faces...",
                                              total=self._loader.count,
                                              leave=False):
            <a id="change">if not metadata:
                msg = ("The images to be sorted do not contain alignment data. Images must have "
                       "been generated by Faceswap&quots Extract process.\nIf you are sorting an "
                       "older faceset, then you should re-extract the faces from your source "
                       "alignments file to generate this data.")
                raise FaceswapError(msg)
           </a> alignments = metadata["alignments"]
            alignedFace = AlignedFace(np.array(alignments["landmarks_xy"], dtype="float32"),
                               image=image,
                               centering="legacy",
                               is_aligned=True)
            <a id="change">filenames.append(filename)</a>
            yaws.append(alignedFace.pose.yaw)

        logger.info("Sorting...")
        matched_list = list(zip(filenames, yaws))</code></pre>