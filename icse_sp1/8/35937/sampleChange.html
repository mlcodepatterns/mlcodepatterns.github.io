<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        form.instance.user = self.request.user
        form.instance.file = form.cleaned_data[&quotupload&quot]

        <a id="change">return super().form_valid(form)</a>


&#47&#47 TODO: permissions, limit by folder
def ck_browse_uploads(request, challenge_short_name):</code></pre><h3>After Change</h3><pre><code class='java'>
        if ck_func_num:
            ck_func_num = escape(ck_func_num)

        <a id="change">url = form.instance.file.url</a>

        if ck_func_num:
            &#47&#47 Respond with Javascript sending ckeditor upload url.
            return HttpResponse(
            &lt;script type=&quottext/javascript&quot&gt;
                window.parent.CKEDITOR.tools.callFunction({0}, &quot{1}&quot);
            &lt;/script&gt;.format(ck_func_num, url))
        else:
            retdata = <a id="change">{&quoturl&quot: url, &quotuploaded&quot: &quot1&quot,
                       &quotfileName&quot: form.instance.file.name}</a>
            <a id="change">return JsonResponse(retdata)</a>


&#47&#47 TODO: permissions, limit by folder
def ck_browse_uploads(request, challenge_short_name):</code></pre>