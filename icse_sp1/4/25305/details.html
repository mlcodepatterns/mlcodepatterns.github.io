<html><h3>f41500f48d5087f531a48059ea0a5339591763ea,python/eight_mile/tf/layers.py,BeamSearchBase,__call__,#BeamSearchBase#Any#,1910
</h3><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            &#47&#47 This makes the index global (e.g. best beams for the second
            &#47&#47 batch example is in [K, 2*K)).
            offsets = np.arange(bsz) * self.K
            offset_beams = <a id="change">tf.cast(best_beams, tf.int64)</a> + tf.expand_dims(offsets, -1)
            flat_beams = tf.reshape(offset_beams, [bsz * self.K])
            &#47&#47 Select the paths to extend based on the best beams
            flat_paths = tf.reshape(paths, [bsz * self.K, -1])</code></pre><h3>After Change</h3><pre><code class='java'>
                done_mask = tf.expand_dims(done_mask, -1)
                &#47&#47 Can creating this mask be moved out of the loop? It never changes but we don&quott have V
                &#47&#47 This mask selects the EOS token
                eos_mask = tf.cast(tf.zeros((1, 1, V)) + tf.reshape(tf.cast(<a id="change">tf.range(V)</a> == Offsets.EOS, tf.float32), (1, 1, V)), done_mask.dtype)
                &#47&#47 eos_mask[:, :, Offsets.EOS] = 1
                &#47&#47 This mask selects the EOS token of only the beams that are done.
                mask = done_mask & eos_mask</code></pre><img src="131950929.png" alt="Italian Trulli"   style="width:500px;height:500px;"><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/dpressel/mead-baseline/commit/f41500f48d5087f531a48059ea0a5339591763ea#diff-56c739f93913ef817fc351cc95027a6046bf8b75e154ee69b54ef8c7c2c3cb21L1945' target='_blank'>Link</a></div><div id='project'> Project Name: dpressel/mead-baseline</div><div id='commit'> Commit Name: f41500f48d5087f531a48059ea0a5339591763ea</div><div id='time'> Time: 2019-11-17</div><div id='author'> Author: blester125@gmail.com</div><div id='file'> File Name: python/eight_mile/tf/layers.py</div><div id='class'> Class Name: BeamSearchBase</div><div id='method'> Method Name: __call__</div><BR><BR><div id='link'><a href='https://github.com/NifTK/NiftyNet/commit/ef234844e1604d5496607fcf48886d9e556c0685#diff-e6cad2aed9da6459b6146989985d3864b326729b92ced5b5ab75cc64429f3b78L91' target='_blank'>Link</a></div><div id='project'> Project Name: NifTK/NiftyNet</div><div id='commit'> Commit Name: ef234844e1604d5496607fcf48886d9e556c0685</div><div id='time'> Time: 2017-06-21</div><div id='author'> Author: r.gray@ucl.ac.uk</div><div id='file'> File Name: engine/training.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: run</div><BR><BR><div id='link'><a href='https://github.com/deepdrive/deepdrive/commit/e64f1d7b07d376634107751903c38e18560ac203#diff-cea9226de99e06ac9648192823fa37f503c003fdd4b6ad5cfe38c1b011101765L137' target='_blank'>Link</a></div><div id='project'> Project Name: deepdrive/deepdrive</div><div id='commit'> Commit Name: e64f1d7b07d376634107751903c38e18560ac203</div><div id='time'> Time: 2018-05-19</div><div id='author'> Author: cquiter@gmail.com</div><div id='file'> File Name: agents/dagger/train/hdf5_to_tfrecord.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: decode</div><BR><BR><div id='link'><a href='https://github.com/dpressel/mead-baseline/commit/f41500f48d5087f531a48059ea0a5339591763ea#diff-56c739f93913ef817fc351cc95027a6046bf8b75e154ee69b54ef8c7c2c3cb21L1945' target='_blank'>Link</a></div><div id='project'> Project Name: dpressel/mead-baseline</div><div id='commit'> Commit Name: f41500f48d5087f531a48059ea0a5339591763ea</div><div id='time'> Time: 2019-11-17</div><div id='author'> Author: blester125@gmail.com</div><div id='file'> File Name: python/eight_mile/tf/layers.py</div><div id='class'> Class Name: BeamSearchBase</div><div id='method'> Method Name: __call__</div><BR>