<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

        if update_period &lt;= 0:
            &#47&#47 User does not want to update the malicious IP list.
            <a id="change">self.outputqueue.put(&quot01|ThreadIntelligence|\t\t[ThreadIntelligence] Updating is not alowed.&quot)</a>
            return False

        if self.__check_if_update(update_period):
            done = self.__download_malicious_ips()</code></pre><h3>After Change</h3><pre><code class='java'>

        &#47&#47 Check if the remote file is newer than our own
        if self.__check_if_update(update_period):
            <a id="change">if self.__download_malicious_ips():
                self.print(&quot\t\tSuccessful Update of remote maliciuos IP file.&quot, 0, 1)
                &#47&#47 Read the last update time from the db
                __database__.set_last_update_time_malicious_file(self.new_update_time)
            else:
                self.print(&quotAn error occured during downloading data for Threat intelligence module. Updating was aborted.&quot, 0, 1)


       </a> else:
            self.print(&quot\t\tMalicious IP is up to date. No downloading.&quot, 0, 1)

        </code></pre>