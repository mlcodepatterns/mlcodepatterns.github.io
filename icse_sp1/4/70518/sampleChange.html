<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                        &#47&#47 Description
                        description = &quotHorizontal Port Scan to port {}. Not Estab TCP from IP: {}. Tot pkts sent all IPs: {}&quot.format(dport, profileid.split(self.fieldseparator)[1], pkts_sent, confidence)
                        __database__.setEvidenceForTW(profileid, twid, key, threat_level, confidence, description)
                        self.print(&quotHorizontal Port Scan to port {}. Not Estab TCP from IP: {}. Tot pkts setn all IPs: {}&quot.format(dport, <a id="change">profileid.split(self.fieldseparator)[1]</a>, pkts_sent),5,0)

                    &#47&#47&#47&#47&#47&#47 PortScan Type 1. Direction OUT
                    dstips = data[dport][&quotdstips&quot]</code></pre><h3>After Change</h3><pre><code class='java'>
                data = __database__.getClientTCPNotEstablishedFromProfileTW(&quotDstIP&quot, profileid, twid)
                &#47&#47 For each dstip, see if the amount of ports connections is over the threshold
                &#47&#47self.print(str(data),4,0)
                for dstip in <a id="change">data.keys()</a>:
                    &#47&#47&#47&#47&#47&#47 PortScan Type 1. Direction OUT
                    &#47&#47 dstports is a dict
                    dstports = data[dstip][&quotdstports&quot]</code></pre>