<html><h3>c177cdcf25c2292c6c1ff5679145da6dbebfa407,perfkitbenchmarker/scripts/spark_sql_runner.py,,main,#Any#,46
</h3><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
  results = []
  for script in args.sql_scripts:
    &#47&#47 Read script from object storage using rdd API
    <a id="change">query = &quot\n&quot.join(spark.sparkContext.textFile(script).collect())</a>

    try:
      logging.info(&quotRunning %s&quot, script)
      start = time.time()</code></pre><h3>After Change</h3><pre><code class='java'>
           .getOrCreate())
  table_metadata = []
  if args.table_metadata:
    <a id="change">table_metadata = json.loads(load_file(spark, args.table_metadata)).items()</a>
  for name, (fmt, options) in table_metadata:
    logging.info(&quotLoading %s&quot, name)
    spark.read.format(fmt).options(**options).load().createTempView(name)
</code></pre><img src="156213262.png" alt="Italian Trulli"   style="width:500px;height:500px;"><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 4</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/GoogleCloudPlatform/PerfKitBenchmarker/commit/c177cdcf25c2292c6c1ff5679145da6dbebfa407#diff-1f1cb796722feeeaf1743cab5d4a033dba5c45013b1168ee951a174c70db575dL47' target='_blank'>Link</a></div><div id='project'> Project Name: GoogleCloudPlatform/PerfKitBenchmarker</div><div id='commit'> Commit Name: c177cdcf25c2292c6c1ff5679145da6dbebfa407</div><div id='time'> Time: 2021-03-10</div><div id='author'> Author: pclay@google.com</div><div id='file'> File Name: perfkitbenchmarker/scripts/spark_sql_runner.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: main</div><BR><BR><div id='link'><a href='https://github.com/ilastik/ilastik/commit/630a400af2bffc27a173acf876d72a1a10cd2dbf#diff-bbb074b80574cb4af67154286e15f599cd49f71beffacaf189f49d3dcf61d091L501' target='_blank'>Link</a></div><div id='project'> Project Name: ilastik/ilastik</div><div id='commit'> Commit Name: 630a400af2bffc27a173acf876d72a1a10cd2dbf</div><div id='time'> Time: 2014-05-08</div><div id='author'> Author: bergs@janelia.hhmi.org</div><div id='file'> File Name: ilastik/applets/base/appletSerializer.py</div><div id='class'> Class Name: SerialClassifierSlot</div><div id='method'> Method Name: _deserialize</div><BR><BR><div id='link'><a href='https://github.com/tensorflow/datasets/commit/3404c3e64990dc7290a944313f3dccca54512710#diff-70002c3595dd84182c2e85194d158c04293d2158132965b629e31848a5da704eL87' target='_blank'>Link</a></div><div id='project'> Project Name: tensorflow/datasets</div><div id='commit'> Commit Name: 3404c3e64990dc7290a944313f3dccca54512710</div><div id='time'> Time: 2019-12-06</div><div id='author'> Author: c.taneja09@gmail.com</div><div id='file'> File Name: tensorflow_datasets/image/food101.py</div><div id='class'> Class Name: Food101</div><div id='method'> Method Name: _generate_examples</div><BR>