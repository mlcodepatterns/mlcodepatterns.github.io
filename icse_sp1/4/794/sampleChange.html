<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    Check if a matrix is symmetric.
    if mat.ndim == 2:
        mat = np.expand_dims(mat, axis=0)
    return <a id="change">np.allclose(mat, mat.transpose(axes=(0, 2, 1)), atol=tolerance)</a>


def make_symmetric(mat):
    Make a matrix fully symmetric to avoid numerical issues.</code></pre><h3>After Change</h3><pre><code class='java'>
    assert mat.ndim == 3
    n_mats, _, _ = mat.shape

    <a id="change">mask = np.zeros(n_mats, dtype=bool)</a>
    for i in range(n_mats):
        <a id="change">mask[i]</a> = np.allclose(mat[i], np.transpose(mat[i]),
                              atol=tolerance)

    return mask</code></pre>