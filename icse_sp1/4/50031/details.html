<html><h3>249c21346208b682d128e28fe4480262f8b76cd8,torch/distributed/optim/zero_redundancy_optimizer.py,ZeroRedundancyOptimizer,state_dict,#ZeroRedundancyOptimizer#,393
</h3><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            partition.append((start, end))
            start = end

        return <a id="change">{
            "state": [s["state"] for s in self._all_states],
            "param_groups": param_groups,
            "partition": partition,
            "local_state_dict": False,
        }</a>

    @staticmethod
    def rank_local_state_dict(rank: int, state_dict: dict) -&gt; dict:
        Returns the local_state_dict for a given rank.</code></pre><h3>After Change</h3><pre><code class='java'>
        

        if len(self._all_states) == 0:
            <a id="change">raise RuntimeError(
                "Optimizer state has not been consolidated on this rank. \
                Please call `consolidate_state_dict()` on all ranks beforehand if you meant to save the global state"
            )</a>

        &#47&#47 Unify the shard states and the state that pytorch would expect, given the model.
        &#47&#47 Indexation needs several redirections, since each shard only knows a limited scope of the model
        &#47&#47 - get the pytorch compliant parameter indexing</code></pre><img src="232614508.png" alt="Italian Trulli"   style="width:500px;height:500px;"><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/pytorch/pytorch/commit/249c21346208b682d128e28fe4480262f8b76cd8#diff-30d3614ba0cf90cf509ef5d96b4e120eb8bfc65a7602b8438a3718f7f197ef6cL393' target='_blank'>Link</a></div><div id='project'> Project Name: pytorch/pytorch</div><div id='commit'> Commit Name: 249c21346208b682d128e28fe4480262f8b76cd8</div><div id='time'> Time: 2021-02-27</div><div id='author'> Author: benjamin.lefaudeux@gmail.com</div><div id='file'> File Name: torch/distributed/optim/zero_redundancy_optimizer.py</div><div id='class'> Class Name: ZeroRedundancyOptimizer</div><div id='method'> Method Name: state_dict</div><BR><BR><div id='link'><a href='https://github.com/onnx/onnxmltools/commit/9a24286338298ed7a75ac564054c5ab8d5580e84#diff-8875270910486ab9a9fb0d63d4f6e0be0c610a0908690ef4c7fcaea194b8e94cL22' target='_blank'>Link</a></div><div id='project'> Project Name: onnx/onnxmltools</div><div id='commit'> Commit Name: 9a24286338298ed7a75ac564054c5ab8d5580e84</div><div id='time'> Time: 2018-05-29</div><div id='author'> Author: wschin@outlook.com</div><div id='file'> File Name: onnxmltools/convert/keras/operator_converters/Pool.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: convert_keras_pooling_core</div><BR><BR><div id='link'><a href='https://github.com/tensorflow/models/commit/0f0c7745d169abd3d9c37e59a7a4ed2b1db14d75#diff-ee421de3daf8a640c16b7f6f5a5d3399d28ded3a5c073b9ee10e5e2a88b7e94fL2333' target='_blank'>Link</a></div><div id='project'> Project Name: tensorflow/models</div><div id='commit'> Commit Name: 0f0c7745d169abd3d9c37e59a7a4ed2b1db14d75</div><div id='time'> Time: 2020-06-26</div><div id='author'> Author: rathodv@google.com</div><div id='file'> File Name: research/object_detection/meta_architectures/center_net_meta_arch.py</div><div id='class'> Class Name: CenterNetMetaArch</div><div id='method'> Method Name: restore_map</div><BR><BR><div id='link'><a href='https://github.com/onnx/onnxmltools/commit/7483270e1df4df7dd2bbe636aa4c5b92bd07fee4#diff-6bd8fd0d594bbe670b1e60cd0f196ef22f7ad9d54a8b60122e4352438789a9c9L135' target='_blank'>Link</a></div><div id='project'> Project Name: onnx/onnxmltools</div><div id='commit'> Commit Name: 7483270e1df4df7dd2bbe636aa4c5b92bd07fee4</div><div id='time'> Time: 2019-11-13</div><div id='author'> Author: xadupre@users.noreply.github.com</div><div id='file'> File Name: onnxmltools/convert/lightgbm/operator_converters/LightGbm.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: convert_lightgbm</div><BR>