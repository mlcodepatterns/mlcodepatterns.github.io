<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            continue
        for association in segment_associations:
            for bpe_idx, candiate_bpe_idxs, candidate_assoc_labels, assoc_probs in association:
                <a id="change">for candidate_idx, candidate_label, candidate_prob in zip(candiate_bpe_idxs, candidate_assoc_labels, assoc_probs):
                    if candidate_label == none_value or candidate_idx not in idx_lookup:
                        continue
                    if idx_lookup[bpe_idx] not in candiates:
                        candiates[idx_lookup[bpe_idx]] = []
                    candiates[idx_lookup[bpe_idx]].append((idx_lookup[candidate_idx], candidate_label, candidate_prob))

    &#47&#47 TODO some how sample these candidates eg maximum probabilities, to fit some schema
   </a> candiates = {k: max(v, key=lambda x: x[2]) for k, v in candiates.items()} &#47&#47 for now just pick maximum prob
    return candiates

</code></pre><h3>After Change</h3><pre><code class='java'>
            for bpe_idx, _, _, _ in association:
                idx_lookups[i][bpe_idx] = active_label_idx

    <a id="change">print("idx lookup", idx_lookups)</a>

    all_candidates = []
    for idx_lookup, doc_label, doc_association in zip(idx_lookups, labels, associations):
        candiates = {}</code></pre>