<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    if gpu_id &gt; -1:
        os.environ["CUDA_VISIBLE_DEVICES"] = str(config.gpu_id)
        if torch.cuda.is_available():
            device = <a id="change">torch.device(&quotcuda:{}&quot.format(gpu_id))</a>
            torch.cuda.set_device(gpu_id)
        else:
            device = torch.device(&quotcpu&quot)
    else:</code></pre><h3>After Change</h3><pre><code class='java'>
            del logits, attn_, p_gen, loss_cv, loss

        with open(os.path.join(save_model_dir, &quotloss.txt&quot), &quota&quot, encoding=&quotutf-8&quot) as f:
            <a id="change">for i in losses:
                f.write(str(i) + &quot\n&quot)
       </a> model_path = os.path.join(save_model_dir, &quotseq2seq_&quot + str(epoch) + &quot_&quot + str(batch_id) + &quot.model&quot)
        with open(model_path, &quotwb&quot) as f:
            torch.save(model.state_dict(), f)
            logger.info("Model save to " + model_path)</code></pre>