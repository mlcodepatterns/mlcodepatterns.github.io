<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
      &#47&#47 todo: offer a complete interpolation after the blacklist or after the generation of the 4C profile if obs/exp not used

      &#47&#47 find minimum nonzero value
      seq_hic_min = <a id="change">np.min(seq_hic_raw[seq_hic_raw &gt; 0])</a>
      <a id="change">seq_hic_raw += seq_hic_min</a>
      &#47&#47 todo: pass an option to add a certain pseudocount value, 
      &#47&#47 todo: or pass adaptive_coarsegrain(ar, countar, cutoff=1, max_levels=8) https://github.com/mirnylab/cooltools/blob/master/cooltools/lib/numutils.py

      &#47&#47 set blacklist to NaNs</code></pre><h3>After Change</h3><pre><code class='java'>
      &#47&#47 interpolate
      seq_hic_interpolated =  interpolate_bad_singletons(seq_hic_smoothed, mask=(~seq_hic_nan),
                                               fillDiagonal=True, returnMask=False, secondPass=True,verbose=False)
      seq_hic_nan = <a id="change">np.isnan(seq_hic_interpolated)</a>
      
      &#47&#47todo: pass an option to add a certain pseudocount value, or the minimum nonzero value
      &#47&#47seq_hic_min = np.min(seq_hic_raw[seq_hic_raw &gt; 0])
      &#47&#47seq_hic_raw += seq_hic_min</code></pre>