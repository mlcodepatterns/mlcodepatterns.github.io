<html><h3>00726c8b57ad409363ede0e754c0137d3fcc71cc,chapter04/car_rental.py,,figure_4_2,#Any#,112
</h3><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                break

        &#47&#47 policy improvement
        new_policy = <a id="change">np.copy(policy)</a>
        for i in range(MAX_CARS + 1):
            for j in range(MAX_CARS + 1):
                action_returns = []
                for action in actions:
                    if (action &gt;= 0 and i &gt;= action) or (action &lt; 0 and j &gt;= abs(action)):
                        action_returns.append(expected_return([i, j], action, value, constant_returned_cars))
                    else:
                        action_returns.append(-float(&quotinf&quot))
                new_policy[i, j] = actions[np.argmax(action_returns)]

        policy_change = (new_policy != policy).sum()
        print(&quotpolicy changed in %d states&quot % (policy_change))
        <a id="change">policy = new_policy</a>
        if policy_change == 0:
            fig = sns.heatmap(np.flipud(value), cmap="YlGnBu", ax=axes[-1])
            fig.set_ylabel(&quot&#47&#47 cars at first location&quot, fontsize=30)
            fig.set_yticks(list(reversed(range(MAX_CARS + 1))))</code></pre><h3>After Change</h3><pre><code class='java'>
                    new_state_value = expected_return([i, j], policy[i, j], value, constant_returned_cars)
                    value[i, j] = new_state_value
            max_value_change = abs(old_value - value).max()
            <a id="change">print(&quotmax value change {}&quot.format(max_value_change))</a>
            if max_value_change &lt; 1e-4:
                break

        &#47&#47 policy improvement</code></pre><img src="226779188.png" alt="Italian Trulli"   style="width:500px;height:500px;"><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 5</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/ShangtongZhang/reinforcement-learning-an-introduction/commit/00726c8b57ad409363ede0e754c0137d3fcc71cc#diff-ac18a0ecc1ff3eec3735c020aee8e6cb549b3c4b769b33c3f823e4b7e4d3cddcL113' target='_blank'>Link</a></div><div id='project'> Project Name: ShangtongZhang/reinforcement-learning-an-introduction</div><div id='commit'> Commit Name: 00726c8b57ad409363ede0e754c0137d3fcc71cc</div><div id='time'> Time: 2019-06-12</div><div id='author'> Author: wlbksy@126.com</div><div id='file'> File Name: chapter04/car_rental.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: figure_4_2</div><BR><BR><div id='link'><a href='https://github.com/dmlc/dgl/commit/6367318f455aa8c27b6341c9b98794351dfd168e#diff-02b81eec7d9c54f1280621c4304a1058bc380cb67cde5c6d336d8e3018bfe3abL10' target='_blank'>Link</a></div><div id='project'> Project Name: dmlc/dgl</div><div id='commit'> Commit Name: 6367318f455aa8c27b6341c9b98794351dfd168e</div><div id='time'> Time: 2020-08-17</div><div id='author'> Author: coin2028@hotmail.com</div><div id='file'> File Name: examples/pytorch/pinsage/data_utils.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: train_test_split_by_time</div><BR><BR><div id='link'><a href='https://github.com/albermax/innvestigate/commit/911aaf10b91a5a09670679d2aeda64473377c1c3#diff-60761cb35ab6deaf556fee69864a7a5d07cd28c7a08bbfb126c8b488830caa45L103' target='_blank'>Link</a></div><div id='project'> Project Name: albermax/innvestigate</div><div id='commit'> Commit Name: 911aaf10b91a5a09670679d2aeda64473377c1c3</div><div id='time'> Time: 2018-03-26</div><div id='author'> Author: philipp.seegerer@tu-berlin.de</div><div id='file'> File Name: examples/mnist_perturbation.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: </div><BR><BR><div id='link'><a href='https://github.com/autorope/donkeycar/commit/d78d0732117d256aafb669b303e79a1da6fe0b26#diff-233029f7bc0f1640e999d6328bf8abcc9ee698ae3d4bcbb7ec97dd648e8feabdL26' target='_blank'>Link</a></div><div id='project'> Project Name: autorope/donkeycar</div><div id='commit'> Commit Name: d78d0732117d256aafb669b303e79a1da6fe0b26</div><div id='time'> Time: 2018-08-04</div><div id='author'> Author: tawnkramer@gmail.com</div><div id='file'> File Name: donkeycar/parts/lidar.py</div><div id='class'> Class Name: RPLidar</div><div id='method'> Method Name: update</div><BR><BR><div id='link'><a href='https://github.com/IndicoDataSolutions/finetune/commit/5f94a31e5e5c6b336f147d5bef669ef456b00c2c#diff-1547974a8044fd7f7327511f1a543d5b6552e8225c0110cd4d9830bb5a8db5b9L321' target='_blank'>Link</a></div><div id='project'> Project Name: IndicoDataSolutions/finetune</div><div id='commit'> Commit Name: 5f94a31e5e5c6b336f147d5bef669ef456b00c2c</div><div id='time'> Time: 2019-08-27</div><div id='author'> Author: madison@indico.io</div><div id='file'> File Name: tests/test_classifier.py</div><div id='class'> Class Name: TestClassifier</div><div id='method'> Method Name: test_reasonable_predictions</div><BR>