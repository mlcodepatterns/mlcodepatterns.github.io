<html><h3>3128e13109c8766eafb413f2428bba976701e929,beginner_source/transformer_tutorial.py,,,#,166
</h3><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
eval_batch_size = 10
train_data = batchify(train_txt, batch_size)
val_data = batchify(val_txt, eval_batch_size)
<a id="change">test_data = batchify(test_txt, eval_batch_size)</a>


&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47&#47
&#47&#47 Functions to generate input and target sequence</code></pre><h3>After Change</h3><pre><code class='java'>
val_data = data_process(iter(io.open(valid_filepath, encoding="utf8")))
test_data = data_process(iter(io.open(test_filepath, encoding="utf8")))

device = torch.device(<a id="change">"cuda" if torch.cuda.is_available() else "cpu"</a>)

def batchify(data, bsz):
    &#47&#47 Divide the dataset into bsz parts.</code></pre><img src="265150253.png" alt="Italian Trulli"   style="width:500px;height:500px;"><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/pytorch/tutorials/commit/3128e13109c8766eafb413f2428bba976701e929#diff-bb6ac9de5f0e95bba9a48afcd9234956764fda31eeb5744e34ac76caf313bd48L164' target='_blank'>Link</a></div><div id='project'> Project Name: pytorch/tutorials</div><div id='commit'> Commit Name: 3128e13109c8766eafb413f2428bba976701e929</div><div id='time'> Time: 2020-12-02</div><div id='author'> Author: 6156351+zhangguanheng66@users.noreply.github.com</div><div id='file'> File Name: beginner_source/transformer_tutorial.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: </div><BR><BR><div id='link'><a href='https://github.com/facebookresearch/pytext/commit/cb8e2c5d60f79803d234da504477193611836d1f#diff-3a17c3878f4cd9c6aa83229ba2f16d3a42d8dbd3a4aee24719d699f985f36d1dL225' target='_blank'>Link</a></div><div id='project'> Project Name: facebookresearch/pytext</div><div id='commit'> Commit Name: cb8e2c5d60f79803d234da504477193611836d1f</div><div id='time'> Time: 2020-04-20</div><div id='author'> Author: stevenliu@fb.com</div><div id='file'> File Name: pytext/task/new_task.py</div><div id='class'> Class Name: _NewTask</div><div id='method'> Method Name: predict</div><BR><BR><div id='link'><a href='https://github.com/dmlc/gluon-nlp/commit/489db85647d6de8a42f9fc5162e1e9ef0831800b#diff-e65d904f83e854a287965667f5aa22a784f2cf18b5348d76831968c1b18c6164L174' target='_blank'>Link</a></div><div id='project'> Project Name: dmlc/gluon-nlp</div><div id='commit'> Commit Name: 489db85647d6de8a42f9fc5162e1e9ef0831800b</div><div id='time'> Time: 2018-08-02</div><div id='author'> Author: leonard@lausen.nl</div><div id='file'> File Name: gluonnlp/data/dataset.py</div><div id='class'> Class Name: LanguageModelDataset</div><div id='method'> Method Name: bptt_batchify</div><BR><BR><div id='link'><a href='https://github.com/dnouri/skorch/commit/e82c5a5ad0873d0ac8bf824b603f163ee5ac18ef#diff-ac9a2e73b0f538e3841f01d74f9bdeada64931ee94b688e48ed506ea08abe8f9L66' target='_blank'>Link</a></div><div id='project'> Project Name: dnouri/skorch</div><div id='commit'> Commit Name: e82c5a5ad0873d0ac8bf824b603f163ee5ac18ef</div><div id='time'> Time: 2017-07-24</div><div id='author'> Author: marian.tietz@ottogroup.com</div><div id='file'> File Name: examples/word_language_model/train.py</div><div id='class'> Class Name: Loader</div><div id='method'> Method Name: __init__</div><BR>