<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
                correct += torch.sum(preds == labels.data)
            epoch_loss = total_loss / len(dataloaders[phase].dataset)
            epoch_acc = correct.double() / len(dataloaders[phase].dataset)
            acc_hist.append(<a id="change">[epoch_loss, epoch_acc]</a>)
            print(&quotEpoch: [{:02d}/{:02d}]---{}, loss: {:.6f}, acc: {:.4f}&quot.format(epoch, N_EPOCH, phase, epoch_loss,
                                                                                  epoch_acc))
            if phase == &quottar&quot and epoch_acc &gt; best_acc:</code></pre><h3>After Change</h3><pre><code class='java'>
        if stop &gt;= args.early_stop:
            break
        print()
    <a id="change">model.load_state_dict(torch.load(&quotmodel.pkl&quot))</a>
    acc_test = test(model, dataloaders[&quottar&quot])
    time_pass = time.time() - since
    print(&quotTraining complete in {:.0f}m {:.0f}s&quot.format(time_pass // 60, time_pass % 60))
    return model, acc_test</code></pre>