<html><h3>60b7f9d068dbe4204a83ed9b90fa0a4138f7d594,poseidon/monitor.py,Monitor,get_hosts,#Monitor#,84
</h3><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 TODO consolidate with update_endpoint_metadata
        hosts = []
        for hash_id, endpoint in self.s.endpoints.items():
            <a id="change">host = {}</a>
            ipv4_os = &quotNO DATA&quot
            role = &quotNO DATA&quot
            if &quotmac_addresses&quot in endpoint.metadata:
                for mac in endpoint.metadata[&quotmac_addresses&quot]:
                    if &quotclassification&quot in endpoint.metadata[&quotmac_addresses&quot][mac]:
                        role = endpoint.metadata[&quotmac_addresses&quot][mac][&quotclassification&quot][&quotlabels&quot][0]
            if &quotipv4_addresses&quot in endpoint.metadata:
                for ip in endpoint.metadata[&quotipv4_addresses&quot]:
                    if ip == endpoint.endpoint_data[&quotipv4&quot]:
                        if &quotshort_os&quot in endpoint.metadata[&quotipv4_addresses&quot][ip]:
                            ipv4_os = endpoint.metadata[&quotipv4_addresses&quot][ip][&quotshort_os&quot]
            <a id="change">host[&quotmac&quot] = endpoint.endpoint_data[&quotmac&quot]</a>
            <a id="change">host[&quotid&quot] = hash_id</a>
            <a id="change">host[&quotactive&quot] = endpoint.endpoint_data[&quotactive&quot]</a>
            <a id="change">host[&quotrole&quot] = role</a>
            <a id="change">host[&quotipv4_os&quot] = ipv4_os</a>
            <a id="change">host[&quotstate&quot] = endpoint.state</a>
            host[&quottenant&quot] = endpoint.endpoint_data[&quottenant&quot]
            <a id="change">host[&quotport&quot] = endpoint.endpoint_data[&quotport&quot]</a>
            <a id="change">host[&quotsegment&quot] = endpoint.endpoint_data[&quotsegment&quot]</a>
            host[&quotipv4&quot] = endpoint.endpoint_data[&quotipv4&quot]
            hosts.append(host)
        return hosts
</code></pre><h3>After Change</h3><pre><code class='java'>
                    if ip == endpoint.endpoint_data[&quotipv4&quot]:
                        if &quotshort_os&quot in endpoint.metadata[&quotipv4_addresses&quot][ip]:
                            ipv4_os = endpoint.metadata[&quotipv4_addresses&quot][ip][&quotshort_os&quot]
            <a id="change">host = {
                &quotmac&quot: endpoint.endpoint_data[&quotmac&quot],
                &quotid&quot: hash_id,
                &quotrole&quot: role,
                &quotipv4_os&quot: ipv4_os,
                &quotstate&quot: endpoint.state,
                &quottenant&quot: endpoint.endpoint_data[&quottenant&quot],
                &quotport&quot: endpoint.endpoint_data[&quotport&quot],
                &quotsegment&quot: endpoint.endpoint_data[&quotsegment&quot],
                &quotipv4&quot: endpoint.endpoint_data[&quotipv4&quot]}</a>
            hosts.append(host)
        return hosts

    def job_update_metrics(self):</code></pre><img src="306752585.png" alt="Italian Trulli"   style="width:500px;height:500px;"><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 22</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/CyberReboot/poseidon/commit/60b7f9d068dbe4204a83ed9b90fa0a4138f7d594#diff-1e0f3805ff93031f805004199b3bb107bfc019ed5c0b63fe1a4b99741dffccb7L88' target='_blank'>Link</a></div><div id='project'> Project Name: CyberReboot/poseidon</div><div id='commit'> Commit Name: 60b7f9d068dbe4204a83ed9b90fa0a4138f7d594</div><div id='time'> Time: 2020-12-14</div><div id='author'> Author: josh@vandervecken.com</div><div id='file'> File Name: poseidon/monitor.py</div><div id='class'> Class Name: Monitor</div><div id='method'> Method Name: get_hosts</div><BR><BR><div id='link'><a href='https://github.com/scipy/scipy/commit/694a088b4ecc62d8ebb2614c5ac66c52c08545d4#diff-658235cff4341d3faaf9489e72de2efd263fc3d328a8f990bfdb06fe73c1a800L144' target='_blank'>Link</a></div><div id='project'> Project Name: scipy/scipy</div><div id='commit'> Commit Name: 694a088b4ecc62d8ebb2614c5ac66c52c08545d4</div><div id='time'> Time: 2015-11-08</div><div id='author'> Author: remy.leone@gmail.com</div><div id='file'> File Name: scipy/weave/c_spec.py</div><div id='class'> Class Name: common_base_converter</div><div id='method'> Method Name: template_vars</div><BR><BR><div id='link'><a href='https://github.com/CyberReboot/poseidon/commit/60b7f9d068dbe4204a83ed9b90fa0a4138f7d594#diff-1e0f3805ff93031f805004199b3bb107bfc019ed5c0b63fe1a4b99741dffccb7L88' target='_blank'>Link</a></div><div id='project'> Project Name: CyberReboot/poseidon</div><div id='commit'> Commit Name: 60b7f9d068dbe4204a83ed9b90fa0a4138f7d594</div><div id='time'> Time: 2020-12-14</div><div id='author'> Author: josh@vandervecken.com</div><div id='file'> File Name: poseidon/monitor.py</div><div id='class'> Class Name: Monitor</div><div id='method'> Method Name: get_hosts</div><BR><BR><div id='link'><a href='https://github.com/CyberReboot/poseidon/commit/3c178ec81b3f42f94acade79bf1b08868fa7347f#diff-1f09426c2cc4253f64860a0da31b0a9f6e05b84212eb03f98bd5ea5baf57ebc2L110' target='_blank'>Link</a></div><div id='project'> Project Name: CyberReboot/poseidon</div><div id='commit'> Commit Name: 3c178ec81b3f42f94acade79bf1b08868fa7347f</div><div id='time'> Time: 2019-10-01</div><div id='author'> Author: josh@vandervecken.com</div><div id='file'> File Name: poseidon/helpers/endpoint.py</div><div id='class'> Class Name: Endpoint</div><div id='method'> Method Name: encode</div><BR>