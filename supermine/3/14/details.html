<html><h3>ca78547252459e307031f1493771f524f83037bf,mmf/modules/embeddings.py,BertVisioLinguisticEmbeddings,get_position_embeddings_visual,#BertVisioLinguisticEmbeddings#,372
</h3><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

            &#47&#47 When fine-tuning the detector , the image_text_alignment is
            &#47&#47 sometimes padded too long.
            if position_embeddings_visual.size(1) != <a id="change">visual_embeddings.size(1)</a>:
                assert position_embeddings_visual.size(1) &gt;= visual_embeddings.size(1)
                position_embeddings_visual = position_embeddings_visual[
                    :, : visual_embeddings.size(1), :</code></pre><h3>After Change</h3><pre><code class='java'>
            &#47&#47 We want to averge along the alignment_number dimension.
            image_text_alignment_mask = image_text_alignment_mask.sum(2)
            image_text_alignment_mask[image_text_alignment_mask == 0] = torch.tensor(
                <a id="change">[1]</a>, dtype=torch.long
            )  &#47&#47 Avoid devide by zero error
            position_embeddings_visual = (
                position_embeddings_visual / image_text_alignment_mask.unsqueeze(-1)</code></pre><img src="7777.png" alt="Italian Trulli"   style="width:500px;height:500px;"><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 2</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/facebookresearch/pythia/commit/ca78547252459e307031f1493771f524f83037bf#diff-983a7317933c54cb57ded93d83ca8f178fb4f43f8ec87e8408ed36ff7879713dL373' target='_blank'>Link</a></div><div id='project'> Project Name: facebookresearch/pythia</div><div id='commit'> Commit Name: ca78547252459e307031f1493771f524f83037bf</div><div id='time'> Time: 2020-09-11</div><div id='author'> Author: vedanujg@gmail.com</div><div id='file'> File Name: mmf/modules/embeddings.py</div><div id='class'> Class Name: BertVisioLinguisticEmbeddings</div><div id='method'> Method Name: get_position_embeddings_visual</div><BR><BR><div id='link'><a href='https://github.com/mapillary/inplace_abn/commit/e6bbf54046cf4567e88cb130300b6b78ec88cb27#diff-da60e8ade9599a15b323c80fc6bed3fa60a2c6c6dc32f0a62839dae0cdbdf82cL98' target='_blank'>Link</a></div><div id='project'> Project Name: mapillary/inplace_abn</div><div id='commit'> Commit Name: e6bbf54046cf4567e88cb130300b6b78ec88cb27</div><div id='time'> Time: 2018-11-28</div><div id='author'> Author: samuel@mapillary.com</div><div id='file'> File Name: test_imagenet.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: validate</div><BR><BR><div id='link'><a href='https://github.com/Scitator/catalyst/commit/f4beaac559e00a3676d942dc7e8fea69efc01cfe#diff-0d5670c5f2a5fcf1725f9db7564e16eeb4669ea8b33c1560f28c55affc6cf2a3L37' target='_blank'>Link</a></div><div id='project'> Project Name: Scitator/catalyst</div><div id='commit'> Commit Name: f4beaac559e00a3676d942dc7e8fea69efc01cfe</div><div id='time'> Time: 2020-11-30</div><div id='author'> Author: raveforlive@gmail.com</div><div id='file'> File Name: catalyst/metrics/mrr.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: mrr</div><BR><BR><div id='link'><a href='https://github.com/nerox8664/pytorch2keras/commit/ad2100bf40e81c9964b9f4c8a3e5a9dbf5f4efd9#diff-c35d8a6503582d2f922496458136175d571c8958874191a579515dce0f500746L16' target='_blank'>Link</a></div><div id='project'> Project Name: nerox8664/pytorch2keras</div><div id='commit'> Commit Name: ad2100bf40e81c9964b9f4c8a3e5a9dbf5f4efd9</div><div id='time'> Time: 2018-11-24</div><div id='author'> Author: nerox8664@gmail.com</div><div id='file'> File Name: tests/layers/view.py</div><div id='class'> Class Name: TestView</div><div id='method'> Method Name: forward</div><BR>