<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    if num_classes is None:
        &#47&#47 as far as we expect the outputs/targets tensors to be int64
        &#47&#47 we could find number of classes as max available number
        <a id="change">num_classes = max(
            int(outputs.max().detach().item() + 1),
            int(targets.max().detach().item() + 1),
        )</a>

    tn = torch.zeros((num_classes,), device=outputs.device)
    fp = torch.zeros((num_classes,), device=outputs.device)
    fn = torch.zeros((num_classes,), device=outputs.device)</code></pre><h3>After Change</h3><pre><code class='java'>
        tensor([0., 0., 0., 1., 1.]), tensor([1., 1., 0., 0., 0.]),
        tensor([1., 1., 0., 1., 1.])
    
    <a id="change">outputs</a>, targets, num_classes = process_multiclass_components(
        outputs=outputs,
        targets=targets,
        argmax_dim=argmax_dim,</code></pre>