<html><h3>81933a874f108043a25f6980334f7242147ddf59,examples/example_mnist_tap_machine.py,,example_mnist_tap_machine,#,13
</h3><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    num_hidden_units = 256
    batch_size = 100
    learning_rate = schedules.power_law_decay(initial=0.1, coefficient=0.1)
    <a id="change">num_terms = 2</a>

    (_, _, shuffled_filepath) = \
            util.default_paths(paysage_path)

    &#47&#47 set up the reader to get minibatches
    data = batch.HDFBatch(shuffled_filepath,
                         &quottrain/images&quot,
                          batch_size,
                          transform=batch.binarize_color,
                          train_fraction=0.95)

    &#47&#47 set up the model and initialize the parameters
    vis_layer = layers.BernoulliLayer(data.ncols)
    hid_layer = layers.BernoulliLayer(num_hidden_units)

    rbm = model.Model([vis_layer, hid_layer])
    rbm.initialize(data, &quotglorot_normal&quot)

    perf  = fit.ProgressMonitor(data,
                                metrics=[&quotReconstructionError&quot,
                                         &quotEnergyDistance&quot,
                                         &quotHeatCapacity&quot])

    opt = optimizers.Gradient(stepsize=learning_rate,
                              tolerance=1e-4,
                              ascent=True)

    sampler = fit.DrivenSequentialMC.from_batch(rbm, data)

    sgd = fit.SGD(rbm, data, opt, num_epochs, sampler=sampler, method=fit.tap, monitor=perf)

    &#47&#47 fit the model
    <a id="change">print(&quotTraining with stochastic gradient ascent using TAP expansion to &quot + str(num_terms) + &quot terms.&quot)</a>
    sgd.train()

    util.show_metrics(rbm, perf)
    valid = data.get(&quotvalidate&quot)</code></pre><h3>After Change</h3><pre><code class='java'>
    sgd = fit.SGD(rbm, data, opt, num_epochs, sampler=sampler, method=fit.tap, monitor=perf)

    &#47&#47 fit the model
    <a id="change">print(&quotTraining with stochastic gradient ascent using TAP expansion&quot)</a>
    sgd.train()

    util.show_metrics(rbm, perf)
    valid = data.get(&quotvalidate&quot)</code></pre><img src="8783354.png" alt="Italian Trulli"   style="width:500px;height:500px;"><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 5</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/drckf/paysage/commit/81933a874f108043a25f6980334f7242147ddf59#diff-88ad126d2f0e5853ef07db66046e345526139843b506dee527c06be60fffd2d2L18' target='_blank'>Link</a></div><div id='project'> Project Name: drckf/paysage</div><div id='commit'> Commit Name: 81933a874f108043a25f6980334f7242147ddf59</div><div id='time'> Time: 2017-05-18</div><div id='author'> Author: charleskennethfisher@gmail.com</div><div id='file'> File Name: examples/example_mnist_tap_machine.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: example_mnist_tap_machine</div><BR><BR><div id='link'><a href='https://github.com/geekcomputers/Python/commit/b13d18d4bbc1464f6bef38c601e48eb4e0d67cbb#diff-bd9f348eade8abce6ab94f080f89bab14aa2fc9f25692ae9c92e743813ade72bL7' target='_blank'>Link</a></div><div id='project'> Project Name: geekcomputers/Python</div><div id='commit'> Commit Name: b13d18d4bbc1464f6bef38c601e48eb4e0d67cbb</div><div id='time'> Time: 2020-04-12</div><div id='author'> Author: 50592495+Prince326@users.noreply.github.com</div><div id='file'> File Name: Print_List_of_Even_Numbers.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: </div><BR><BR><div id='link'><a href='https://github.com/thoughtworksarts/EmoPy/commit/7b6fd231d17cd1fd88c1fc163a33f1049d63e7b0#diff-4a52fc160739f6a29370a2613b68696e0f4d7d41dd89026ad96d64a08797a207L7' target='_blank'>Link</a></div><div id='project'> Project Name: thoughtworksarts/EmoPy</div><div id='commit'> Commit Name: 7b6fd231d17cd1fd88c1fc163a33f1049d63e7b0</div><div id='time'> Time: 2018-04-26</div><div id='author'> Author: angelica.perez37@gmail.com</div><div id='file'> File Name: examples/convolutional_lstm_model.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: </div><BR>