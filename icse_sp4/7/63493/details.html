<html><h3>c1b3482f575bf75557c8072b3f857672bddd3588,examples/transferlearning_model.py,,,#,4
</h3><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

data_loader = DataLoader(from_csv=True, emotion_map=fer_dataset_label_map, datapath=csv_file_path,
                         image_dimensions=raw_dimensions, csv_label_col=0, csv_image_col=1, out_channels=3)
<a id="change">images</a>, labels, emotion_map = data_loader.get_data()
if verbose:
    print(&quotraw image shape: &quot + str(images.shape))
</code></pre><h3>After Change</h3><pre><code class='java'>
data_loader = DataLoader(from_csv=True, emotion_map=fer_dataset_label_map, datapath=csv_file_path,
                         image_dimensions=raw_dimensions, csv_label_col=0, csv_image_col=1, out_channels=3)
dataset = data_loader.get_data()
<a id="change">labels = dataset.get_labels()</a>
<a id="change">images = dataset.get_images()</a>

if verbose:
    print(&quotraw image shape: &quot + str(images.shape))

print(&quotCreating training/testing data...&quot)
validation_split = 0.15
X_train, X_test, y_train, y_test = train_test_split(images, labels,
                                                    test_size=validation_split, random_state=42, stratify=labels)
train_gen = DataGenerator().fit(X_train, y_train)
test_gen = DataGenerator().fit(X_test, y_test)

print(&quot--------------- Inception-V3 Model -------------------&quot)
print(&quotInitializing neural network with InceptionV3 base model...&quot)
model = TransferLearningNN(model_name=model_name, emotion_map=<a id="change">dataset.get_emotion_index_map()</a>)

print(&quotTraining model...&quot)
print(&quotnumLayers: &quot + str(len(model.model.layers)))</code></pre><img src="295106674.png" alt="Italian Trulli"   style="width:500px;height:500px;"><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 6</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/thoughtworksarts/EmoPy/commit/c1b3482f575bf75557c8072b3f857672bddd3588#diff-c4c44346344579b2af745d2e70f32ab74cfd80a5b2a289d99fe9439a33ed7ee7L22' target='_blank'>Link</a></div><div id='project'> Project Name: thoughtworksarts/EmoPy</div><div id='commit'> Commit Name: c1b3482f575bf75557c8072b3f857672bddd3588</div><div id='time'> Time: 2018-04-26</div><div id='author'> Author: angelica.perez37@gmail.com</div><div id='file'> File Name: examples/transferlearning_model.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: </div><BR><BR><div id='link'><a href='https://github.com/thoughtworksarts/EmoPy/commit/a71f947ef53d1adb3dc0325c121dff2f3809a738#diff-4a52fc160739f6a29370a2613b68696e0f4d7d41dd89026ad96d64a08797a207L9' target='_blank'>Link</a></div><div id='project'> Project Name: thoughtworksarts/EmoPy</div><div id='commit'> Commit Name: a71f947ef53d1adb3dc0325c121dff2f3809a738</div><div id='time'> Time: 2018-04-26</div><div id='author'> Author: angelica.perez37@gmail.com</div><div id='file'> File Name: examples/convolutional_lstm_model.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: </div><BR><BR><div id='link'><a href='https://github.com/thoughtworksarts/EmoPy/commit/f9761b45d25b28cb952a4a90346e58e730b5099d#diff-cb3809abb78287fa8597abd877d4c0f541c64570a7e9ce62fc4887d0ab99eb61L18' target='_blank'>Link</a></div><div id='project'> Project Name: thoughtworksarts/EmoPy</div><div id='commit'> Commit Name: f9761b45d25b28cb952a4a90346e58e730b5099d</div><div id='time'> Time: 2018-04-26</div><div id='author'> Author: angelica.perez37@gmail.com</div><div id='file'> File Name: examples/convolutional_model.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: </div><BR><BR><div id='link'><a href='https://github.com/thoughtworksarts/EmoPy/commit/a71f947ef53d1adb3dc0325c121dff2f3809a738#diff-d6e61b85eb714ffb73e54ff49fb8cab0bf43187c535ba0922e243c15c405924eL14' target='_blank'>Link</a></div><div id='project'> Project Name: thoughtworksarts/EmoPy</div><div id='commit'> Commit Name: a71f947ef53d1adb3dc0325c121dff2f3809a738</div><div id='time'> Time: 2018-04-26</div><div id='author'> Author: angelica.perez37@gmail.com</div><div id='file'> File Name: examples/timedelay_conv_model.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: </div><BR>