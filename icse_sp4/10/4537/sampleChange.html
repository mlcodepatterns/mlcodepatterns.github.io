<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    &#47&#47 tgt_out_idx shape: batch_size, seq_len
    &#47&#47 output shape: batch_size, 1
    return torch.prod(
        <a id="change">torch</a>.gather(per_symbol_probs, <a id="change">2</a>, tgt_out_idx.unsqueeze(<a id="change">-1</a>)).squeeze(2),
        dim=1,
        keepdim=True,
    )</code></pre><h3>After Change</h3><pre><code class='java'>
    &#47&#47 output shape: batch_size, 1
    return (
        torch.prod(
            <a id="change">torch.gather(per_symbol_probs, 2, tgt_out_idx.unsqueeze(2)).squeeze(2)</a>,
            dim=1,
            keepdim=True,
        )</code></pre>