<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            )

        &#47&#47 initialize diversity penalty
        if <a id="change">self.diversity_buf is None:
</a>            self.diversity_buf = <a id="change">lprobs.new()</a>
        self.diversity_buf.resize_(lprobs[:, 0, :].size())
        torch.zeros(lprobs[:, 0, :].size(), out=self.diversity_buf)

        scores_G, indices_G, beams_G = [], [], []</code></pre><h3>After Change</h3><pre><code class='java'>
            )

        &#47&#47 initialize diversity penalty
        diversity_buf = <a id="change">torch.zeros(lprobs[:, 0, :].size()).to(lprobs)</a>

        scores_G, indices_G, beams_G = [], [], []
        for g in range(self.num_groups):
            lprobs_g = lprobs[:, g :: self.num_groups, :]</code></pre>