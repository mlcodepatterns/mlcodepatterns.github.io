<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    for k in time_step_spec.observation.keys():
      if k == &quotdirection&quot:
        shape = [1]
      elif <a id="change">k</a> == &quotimage&quot:
        &#47&#47 Remove agent dimension
        shape = time_step_spec.observation[k].shape[1:]
      else:</code></pre><h3>After Change</h3><pre><code class='java'>
          maximum=spec.maximum,
          dtype=spec.dtype)

    <a id="change">single_obs_spec = tf.nest.map_structure(make_single_agent_spec,
                                            time_step_spec.observation)</a>
    single_reward_spec = tensor_spec.TensorSpec(
        shape=(), dtype=time_step_spec.reward.dtype, name=&quotreward&quot)
    single_time_step_spec = ts_lib.TimeStep(time_step_spec.step_type,
                                            single_reward_spec,</code></pre>