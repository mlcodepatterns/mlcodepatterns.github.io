<html><h3>e375ba1b22e90e32eddad1697557585c2e9d0229,book_figures/chapter7/fig_spec_reconstruction.py,,,#,21
</h3><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

&#47&#47------------------------------------------------------------
&#47&#47 Plot the sequence of reconstructions
fig = plt.figure(figsize=<a id="change">(8, 8)</a>)
<a id="change">fig.subplots_adjust(hspace=0)</a>

for i, n in enumerate([0, 4, 8, 20]):
    ax = fig.add_subplot(411 + i)
    ax.plot(wavelengths, spec, &quot-&quot, c=&quotgray&quot)</code></pre><h3>After Change</h3><pre><code class='java'>

&#47&#47 Adjust font sizes for text
import matplotlib
<a id="change">matplotlib.rc(&quotfont&quot, size=8)</a>


&#47&#47------------------------------------------------------------
&#47&#47 Download data
data = sdss_corrected_spectra.fetch_sdss_corrected_spectra()
spectra = sdss_corrected_spectra.reconstruct_spectra(data)
wavelengths = sdss_corrected_spectra.compute_wavelengths(data)

&#47&#47------------------------------------------------------------
&#47&#47 Compute PCA components

&#47&#47 Eigenvalues can be computed using PCA as in the commented code below:

&#47&#47from sklearn.decomposition import PCA
&#47&#47pca = PCA()
&#47&#47pca.fit(spectra)
&#47&#47evals = pca.explained_variance_ratio_
&#47&#47evals_cs = evals.cumsum()

&#47&#47  because the spectra have been reconstructed from masked values, this
&#47&#47  is not exactly correct in this case: we&quotll use the values computed
&#47&#47  in the file compute_sdss_pca.py
evals = data[&quotevals&quot] ** 2
evals_cs = evals.cumsum()
evals_cs /= evals_cs[-1]
evecs = data[&quotevecs&quot]
spec_mean = spectra.mean(0)

&#47&#47------------------------------------------------------------
&#47&#47 Find the coefficients of a particular spectrum
spec = spectra[1]
coeff = np.dot(evecs, spec - spec_mean)

&#47&#47------------------------------------------------------------
&#47&#47 Plot the sequence of reconstructions
fig = plt.figure(figsize=<a id="change">(5, 5)</a>)
<a id="change">fig.subplots_adjust(hspace=0, top=0.95, bottom=0.1, left=0.12, right=0.93)</a>

for i, n in enumerate([0, 4, 8, 20]):
    ax = fig.add_subplot(411 + i)
    ax.plot(wavelengths, spec, &quot-&quot, c=&quotgray&quot)</code></pre><img src="173685338.png" alt="Italian Trulli"   style="width:500px;height:500px;"><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 5</div><BR><div id='size'>Non-data size: 6</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/astroML/astroML/commit/e375ba1b22e90e32eddad1697557585c2e9d0229#diff-c382200ab465be18a09daab878b71e50461c029ff4cc6d9d6629902d1a8e2beaL21' target='_blank'>Link</a></div><div id='project'> Project Name: astroML/astroML</div><div id='commit'> Commit Name: e375ba1b22e90e32eddad1697557585c2e9d0229</div><div id='time'> Time: 2013-06-10</div><div id='author'> Author: vanderplas@astro.washington.edu</div><div id='file'> File Name: book_figures/chapter7/fig_spec_reconstruction.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: </div><BR><BR><div id='link'><a href='https://github.com/astroML/astroML/commit/4ea4d80185237cfef0c06331cc66a5f5effe76d7#diff-0e191ed8ee09a6c8652d2cf371df24a62df5dbfca7562d7baf3509cdf5bfa071L21' target='_blank'>Link</a></div><div id='project'> Project Name: astroML/astroML</div><div id='commit'> Commit Name: 4ea4d80185237cfef0c06331cc66a5f5effe76d7</div><div id='time'> Time: 2013-06-09</div><div id='author'> Author: vanderplas@astro.washington.edu</div><div id='file'> File Name: book_figures/chapter5/fig_bayes_blocks.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: </div><BR><BR><div id='link'><a href='https://github.com/astroML/astroML/commit/37bbaac45d9448d74e365ddf3188b0fa0fa316cb#diff-f65fe50b8fdd64ba2e57fae376c227cf89f612f22c363b342447e39309694d21L21' target='_blank'>Link</a></div><div id='project'> Project Name: astroML/astroML</div><div id='commit'> Commit Name: 37bbaac45d9448d74e365ddf3188b0fa0fa316cb</div><div id='time'> Time: 2013-06-09</div><div id='author'> Author: vanderplas@astro.washington.edu</div><div id='file'> File Name: book_figures/chapter6/fig_GMM_density_estimation.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: </div><BR><BR><div id='link'><a href='https://github.com/astroML/astroML/commit/37bbaac45d9448d74e365ddf3188b0fa0fa316cb#diff-2480445c300abd224d830d75376aa8f53d2e35a40de2d8bc97eb56f2dec73bf1L20' target='_blank'>Link</a></div><div id='project'> Project Name: astroML/astroML</div><div id='commit'> Commit Name: 37bbaac45d9448d74e365ddf3188b0fa0fa316cb</div><div id='time'> Time: 2013-06-09</div><div id='author'> Author: vanderplas@astro.washington.edu</div><div id='file'> File Name: book_figures/chapter6/fig_density_estimation.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: </div><BR><BR><div id='link'><a href='https://github.com/astroML/astroML/commit/e375ba1b22e90e32eddad1697557585c2e9d0229#diff-db533ad2bd0865b08c8c31ac202b4b003d7059bdcdd0bd4022fb5ee0982651f0L21' target='_blank'>Link</a></div><div id='project'> Project Name: astroML/astroML</div><div id='commit'> Commit Name: e375ba1b22e90e32eddad1697557585c2e9d0229</div><div id='time'> Time: 2013-06-10</div><div id='author'> Author: vanderplas@astro.washington.edu</div><div id='file'> File Name: book_figures/chapter7/fig_PCA_reconstruction.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: </div><BR>