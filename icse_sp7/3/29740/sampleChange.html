<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        
    
     
    <a id="change">if not hasattr(settings,"COMIC_PUBLIC_FOLDER_NAME"):
        raise ImproperlyConfigured("Don&quott know from which folder serving files is allowed. Please add a setting \
                                    &quotCOMIC_PUBLIC_FOLDER_NAME = \"public_html\" to your .conf file." )
 
   </a> if not filepath.startswith(settings.COMIC_PUBLIC_FOLDER_NAME):
        &#47&#47FIXME:  throw 403 or proper permission denied here
        raise Http404("Permission Denied. Only objects in folder named &quot%s&quot can be served without credentials\
                       FIXME: throw proper 403 or permission denied here." % settings.COMIC_PUBLIC_FOLDER_NAME )        </code></pre><h3>After Change</h3><pre><code class='java'>
    filename = path.join(settings.DROPBOX_ROOT,site_short_name,filepath)
    
    
    if <a id="change">can_access(request.user,          
                  filename,
                  site_short_name,          
                  override_permission=ComicSiteModel.REGISTERED_ONLY)</a>:
        
        try:            
            file = open(filename,"rb")        </code></pre>