<html><h3>296881376f1d04fd189ec2dfa7878400a59d2b1d,slm_lab/agent/algorithm/dqn.py,DQNBase,calc_q_loss,#DQNBase#Any#,195
</h3><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 Use online_net to select actions in next state
        online_next_q_preds = self.online_net(batch[&quotnext_states&quot])
        &#47&#47 Use eval_net to calculate next_q_preds for actions chosen by online_net
        next_q_preds = self.eval_net(<a id="change">batch[&quotnext_states&quot]</a>)
        max_next_q_preds = next_q_preds.gather(-1, online_next_q_preds.argmax(dim=-1, keepdim=True)).squeeze(-1)
        max_q_targets = batch[&quotrewards&quot] + self.gamma * (1 - batch[&quotdones&quot]) * max_next_q_preds
        max_q_targets = max_q_targets.detach()</code></pre><h3>After Change</h3><pre><code class='java'>
        if self.body.env.is_venv:
            states = math_util.venv_unpack(states)
            next_states = math_util.venv_unpack(next_states)
        <a id="change">q_preds = self.net(states)</a>
        &#47&#47 Use online_net to select actions in next state
        online_next_q_preds = self.online_net(next_states)
        &#47&#47 Use eval_net to calculate next_q_preds for actions chosen by online_net
        next_q_preds = self.eval_net(next_states)</code></pre><img src="80338792.png" alt="Italian Trulli"   style="width:500px;height:500px;"><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/kengz/SLM-Lab/commit/296881376f1d04fd189ec2dfa7878400a59d2b1d#diff-b313dc5b2666a20ac9264bc62d4994e5ea8f611a431daa824eaa222efe04ec19L195' target='_blank'>Link</a></div><div id='project'> Project Name: kengz/SLM-Lab</div><div id='commit'> Commit Name: 296881376f1d04fd189ec2dfa7878400a59d2b1d</div><div id='time'> Time: 2019-04-30</div><div id='author'> Author: kengzwl@gmail.com</div><div id='file'> File Name: slm_lab/agent/algorithm/dqn.py</div><div id='class'> Class Name: DQNBase</div><div id='method'> Method Name: calc_q_loss</div><BR><BR><div id='link'><a href='https://github.com/NifTK/NiftyNet/commit/2f50617c8039945bdd0634f6e28cd9728acbab38#diff-0a628315996f9fabe6d668810b52167ecddf16e6058f4b84a4fcdee23c07582bL61' target='_blank'>Link</a></div><div id='project'> Project Name: NifTK/NiftyNet</div><div id='commit'> Commit Name: 2f50617c8039945bdd0634f6e28cd9728acbab38</div><div id='time'> Time: 2017-11-03</div><div id='author'> Author: wenqi.li@ucl.ac.uk</div><div id='file'> File Name: niftynet/application/label_driven_registration.py</div><div id='class'> Class Name: RegApp</div><div id='method'> Method Name: connect_data_and_network</div><BR><BR><div id='link'><a href='https://github.com/kengz/SLM-Lab/commit/58b42927fc44b779e8c7dd8507d6cfebe344f2ef#diff-b313dc5b2666a20ac9264bc62d4994e5ea8f611a431daa824eaa222efe04ec19L195' target='_blank'>Link</a></div><div id='project'> Project Name: kengz/SLM-Lab</div><div id='commit'> Commit Name: 58b42927fc44b779e8c7dd8507d6cfebe344f2ef</div><div id='time'> Time: 2019-05-01</div><div id='author'> Author: kengzwl@gmail.com</div><div id='file'> File Name: slm_lab/agent/algorithm/dqn.py</div><div id='class'> Class Name: DQNBase</div><div id='method'> Method Name: calc_q_loss</div><BR>