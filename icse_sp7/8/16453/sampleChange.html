<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>


    def duplicates_score(self, stats, columns, col_name):
        <a id="change">duplicates = len(columns[col_name]) - len(set(columns[col_name]))</a>
        data = {
            &quotduplicates&quot: duplicates
            ,&quotduplicates_percentage&quot: duplicates*100/len(columns[col_name])
        }</code></pre><h3>After Change</h3><pre><code class='java'>
            &#47&#47  duplicate_score, a quality score based on said percentage
        

        <a id="change">occurances = Counter(columns[col_name])</a>
        <a id="change">values_that_occur_twice_or_more = filter(lambda val: occurances[val] &lt; 2, occurances)</a>
        <a id="change">nr_of_occurances = map(lambda val: occurances[val], values_that_occur_twice_or_more)</a>
        <a id="change">nr_duplicates = sum(values_that_occur_twice_or_more)</a>
        data = {
            &quotnr_duplicates&quot: nr_duplicates
            ,&quotduplicates_percentage&quot: nr_duplicates*100/len(columns[col_name])
        }</code></pre>