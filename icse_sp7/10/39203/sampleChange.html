<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
             location.replace(&quothttp://www.w3af.com/&quot);
            
        res = self._script_re.search(response.get_body())
        <a id="change">if res:

            url_group_re = &quot(%s)&quot % &quot|&quot.join(self.TEST_URLS)

            for script_code in res.groups():
                script_code = script_code.split(&quot\n&quot)
                code = []
                for i in script_code:
                    code.extend(i.split(&quot;&quot))

                for line in code:
                    if re.search(&quot(window\.location|location\.).*&quot + url_group_re, line):
                        return True

       </a> return False

    def get_long_desc(self):
        </code></pre><h3>After Change</h3><pre><code class='java'>
            window.navigate(&quothttp://www.w3af.org&quot);
        
        for statement in self._extract_script_code(response):
            <a id="change">if self.TEST_DOMAIN not in statement:
                continue

           </a> <a id="change">for redir_to_test_domain_re in self.REDIR_TO_TEST_DOMAIN_JS_RE:
                if redir_to_test_domain_re.search(statement):
                    return True

       </a> return False

    def get_long_desc(self):
        </code></pre>