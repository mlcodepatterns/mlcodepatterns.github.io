<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            &quoterrors&quot: list()
        }

        <a id="change">fields = (&quotpk&quot, &quotapplicant_id&quot, &quotyear&quot, &quotdocument_id&quot)</a>
        documents = Document.objects.only(*fields).iterator()

        with Pool(processes=options[&quotprocesses&quot]) as pool:
            for url, updated, error in <a id="change">pool.imap(update_url, documents)</a>:
                self.update_progress(url, updated, error)
                print(self.summary(), end=&quot\r&quot)
</code></pre><h3>After Change</h3><pre><code class='java'>
        )

    def handle(self, *args, **options):
        <a id="change">print(&quot==&gt; Looking for documents to update&quot)</a>
        limit = now() - timedelta(days=options[&quotdays&quot])
        qs = Document.objects.filter(receipt_url_last_update__lt=limit)
        total = qs.count()
        self.progress = {</code></pre>