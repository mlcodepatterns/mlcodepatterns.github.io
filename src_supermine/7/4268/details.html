<html><h3>6c91204831b4c7628ed6b0975b26df039f866c2c,deeppavlov/models/classifiers/intents/intent_model.py,KerasIntentModel,train,#KerasIntentModel#Any#,159
</h3><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>

        print(&quot\n____Training over {} samples____\n\n&quot.format(n_train_samples))

        <a id="change">while epochs_done &lt; self.opt[&quotepochs&quot]:
            batch_gen = dataset.batch_generator(batch_size=self.opt[&quotbatch_size&quot],
                                                data_type=&quottrain&quot)
            for step, batch in enumerate(batch_gen):
                metrics_values = self.train_on_batch(batch)
                updates += 1

                if self.opt[&quotverbose&quot] and step % 50 == 0:
                    log_metrics(names=self.metrics_names,
                                values=metrics_values,
                                updates=updates,
                                mode=&quottrain&quot)

            epochs_done += 1
            if epochs_done % self.opt[&quotval_every_n_epochs&quot] == 0:
                if &quotvalid&quot in dataset.data.keys():
                    valid_metrics_values = self.model.test_on_batch(x=valid_x, y=valid_y)

                    log_metrics(names=self.metrics_names,
                                values=valid_metrics_values,
                                mode=&quotvalid&quot)
                    if valid_metrics_values[0] &gt; val_loss:
                        val_increase += 1
                        print("__Validation impatience {} out of {}".format(
                            val_increase, self.opt[&quotval_patience&quot]))
                        if val_increase == self.opt[&quotval_patience&quot]:
                            print("___Stop training: validation is out of patience___")
                            break
                    else:
                        val_increase = 0
                        val_loss = valid_metrics_values[0]
            print(&quotepochs_done: {}&quot.format(epochs_done))

       </a> self.save()

    def infer(self, data, return_proba=False, *args):
        </code></pre><h3>After Change</h3><pre><code class='java'>

        print(&quot\n____Training over {} samples____\n\n&quot.format(n_train_samples))

        <a id="change">try:
            while epochs_done &lt; self.opt[&quotepochs&quot]:
                batch_gen = dataset.batch_generator(batch_size=self.opt[&quotbatch_size&quot],
                                                    data_type=&quottrain&quot)
                for step, batch in enumerate(batch_gen):
                    metrics_values = self.train_on_batch(batch)
                    updates += 1

                    if self.opt[&quotverbose&quot] and step % 50 == 0:
                        log_metrics(names=self.metrics_names,
                                    values=metrics_values,
                                    updates=updates,
                                    mode=&quottrain&quot)

                epochs_done += 1
                if epochs_done % self.opt[&quotval_every_n_epochs&quot] == 0:
                    if &quotvalid&quot in dataset.data.keys():
                        valid_metrics_values = self.model.test_on_batch(x=valid_x, y=valid_y)

                        log_metrics(names=self.metrics_names,
                                    values=valid_metrics_values,
                                    mode=&quotvalid&quot)
                        if valid_metrics_values[0] &gt; val_loss:
                            val_increase += 1
                            print("__Validation impatience {} out of {}".format(
                                val_increase, self.opt[&quotval_patience&quot]))
                            if val_increase == self.opt[&quotval_patience&quot]:
                                print("___Stop training: validation is out of patience___")
                                break
                        else:
                            val_increase = 0
                            val_loss = valid_metrics_values[0]
                print(&quotepochs_done: {}&quot.format(epochs_done))
        except KeyboardInterrupt:
            print(&quotInterrupted&quot, file=sys.stderr)

       </a> self.save()

    def infer(self, data, return_proba=False, *args):
        </code></pre><img src="19065899.png" alt="Italian Trulli"   style="width:500px;height:500px;"><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 4</div><BR><div id='size'>Non-data size: 6</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/deepmipt/DeepPavlov/commit/6c91204831b4c7628ed6b0975b26df039f866c2c#diff-532c3630d2037af48e0ddf86e61b2443de55e36e572547ab262ee1ab41c0cd05L187' target='_blank'>Link</a></div><div id='project'> Project Name: deepmipt/DeepPavlov</div><div id='commit'> Commit Name: 6c91204831b4c7628ed6b0975b26df039f866c2c</div><div id='time'> Time: 2018-01-18</div><div id='author'> Author: dilyara.rimovna@gmail.com</div><div id='file'> File Name: deeppavlov/models/classifiers/intents/intent_model.py</div><div id='class'> Class Name: KerasIntentModel</div><div id='method'> Method Name: train</div><BR><BR><div id='link'><a href='https://github.com/deepmipt/DeepPavlov/commit/0ddd27b71f54be5682da90473d00ea671a3459ca#diff-532c3630d2037af48e0ddf86e61b2443de55e36e572547ab262ee1ab41c0cd05L175' target='_blank'>Link</a></div><div id='project'> Project Name: deepmipt/DeepPavlov</div><div id='commit'> Commit Name: 0ddd27b71f54be5682da90473d00ea671a3459ca</div><div id='time'> Time: 2018-01-29</div><div id='author'> Author: arkhipov@yahoo.com</div><div id='file'> File Name: deeppavlov/models/classifiers/intents/intent_model.py</div><div id='class'> Class Name: KerasIntentModel</div><div id='method'> Method Name: train</div><BR><BR><div id='link'><a href='https://github.com/deepmipt/DeepPavlov/commit/c04aefe07dad54610c49e7841410c85876896b34#diff-532c3630d2037af48e0ddf86e61b2443de55e36e572547ab262ee1ab41c0cd05L169' target='_blank'>Link</a></div><div id='project'> Project Name: deepmipt/DeepPavlov</div><div id='commit'> Commit Name: c04aefe07dad54610c49e7841410c85876896b34</div><div id='time'> Time: 2018-01-24</div><div id='author'> Author: yoptar@gmail.com</div><div id='file'> File Name: deeppavlov/models/classifiers/intents/intent_model.py</div><div id='class'> Class Name: KerasIntentModel</div><div id='method'> Method Name: train</div><BR><BR><div id='link'><a href='https://github.com/deepmipt/DeepPavlov/commit/cc2b39fcae8c813851d704e50b390fdac607c914#diff-a973a9930124b9712c1cac8b4626201558afee53722e6f06336a8fa56d4ca56dL140' target='_blank'>Link</a></div><div id='project'> Project Name: deepmipt/DeepPavlov</div><div id='commit'> Commit Name: cc2b39fcae8c813851d704e50b390fdac607c914</div><div id='time'> Time: 2018-01-24</div><div id='author'> Author: yoptar@gmail.com</div><div id='file'> File Name: deeppavlov/core/commands/train.py</div><div id='class'> Class Name: </div><div id='method'> Method Name: train_batches</div><BR>