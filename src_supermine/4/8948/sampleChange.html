<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        assert isinstance(traffic_policy_dictionary,
                          dict), "Traffic policy must be dictionary"
        prob = 0
        <a id="change">existing_backends = set(self.get_all_backends())</a>
        for backend, weight in traffic_policy_dictionary.items():
            prob += weight
            assert backend in existing_backends, \
                "Attempted to assign traffic to a backend &quot{}&quot that " \</code></pre><h3>After Change</h3><pre><code class='java'>
                prob, 1, atol=0.02
            ), "weights must sum to 1, currently they sum to {}".format(prob)

            <a id="change">self.traffic_policies[endpoint_name]</a> = traffic_policy_dictionary

            &#47&#47 NOTE(edoakes): we must write a checkpoint before pushing the
            &#47&#47 update to avoid inconsistent state if we crash after pushing the</code></pre>