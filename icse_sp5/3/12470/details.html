<html><h3>15ff4acfc4438dab85155acdf0b8fdb9e1292e0f,QUANTAXIS/QABacktest/QABacktest.py,QA_Backtest_stock_day,__end_of_backtest,#QA_Backtest_stock_day#,842
</h3><link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            &quottime&quot: datetime.datetime.now()
        }
        QA_SU_save_backtest_message(_backtest_mes, self.setting.client)
        <a id="change">QA_SU_save_account_message(__messages, self.setting.client)</a>
        QA_SU_save_account_to_csv(__messages)
        &#47&#47 QA.QA_SU_save_backtest_message(analysis_message, self.setting.client)

    def QA_backtest_excute_bid(self, __result,  __date, __hold, __code, __amount):</code></pre><h3>After Change</h3><pre><code class='java'>
        self.__benchmark_data = QA_fetch_index_day(
            self.benchmark_code, self.start_real_date,
            self.end_real_date)
        <a id="change">if len(self.__messages)&gt;1:
            performace = QA_backtest_analysis_start(
                self.setting.client, self.strategy_stock_list,self.__messages,
                self.trade_list[self.start_real_id:self.end_real_id + 1],
                self.market_data, self.__benchmark_data)
            _backtest_mes = {
                &quotuser&quot: self.setting.QA_setting_user_name,
                &quotstrategy&quot: self.strategy_name,
                &quotstock_list&quot: performace[&quotcode&quot],
                &quotstart_time&quot: self.strategy_start_date,
                &quotend_time&quot: self.strategy_end_date,
                &quotaccount_cookie&quot: self.account.account_cookie,
                &quotannualized_returns&quot: performace[&quotannualized_returns&quot],
                &quotbenchmark_annualized_returns&quot: performace[&quotbenchmark_annualized_returns&quot],
                &quotassets&quot: performace[&quotassets&quot],
                &quotbenchmark_assets&quot: performace[&quotbenchmark_assets&quot],
                &quottrade_date&quot: performace[&quottrade_date&quot],
                &quottotal_date&quot: performace[&quottotal_date&quot],
                &quotwin_rate&quot: performace[&quotwin_rate&quot],
                &quotalpha&quot: performace[&quotalpha&quot],
                &quotbeta&quot: performace[&quotbeta&quot],
                &quotsharpe&quot: performace[&quotsharpe&quot],
                &quotvol&quot: performace[&quotvol&quot],
                &quotbenchmark_vol&quot: performace[&quotbenchmark_vol&quot],
                &quotmax_drop&quot: performace[&quotmax_drop&quot],
                &quotexist&quot: __exist_time,
                &quottime&quot: datetime.datetime.now()
            }
            QA_SU_save_backtest_message(_backtest_mes, self.setting.client)
            QA_SU_save_account_message(self.__messages, self.setting.client)
            QA_SU_save_account_to_csv(self.__messages)
        &#47&#47 QA.QA_SU_save_backtest_message(analysis_message, self.setting.client)

   </a> def QA_backtest_excute_bid(self, __result,  __date, __hold, __code, __amount):
        
        这里是处理报价的逻辑部分
        2017/7/19 修改</code></pre><img src="76763099.png" alt="Italian Trulli"   style="width:500px;height:500px;"><div id='inPattern'>In pattern: SUPERPATTERN</div><BR><div id='frequency'>Frequency: 3</div><BR><div id='size'>Non-data size: 3</div><BR><h3>Instances</h3><BR><div id='link'><a href='https://github.com/QUANTAXIS/QUANTAXIS/commit/15ff4acfc4438dab85155acdf0b8fdb9e1292e0f#diff-ff318f3aaf648a4356f55f24bc50241310aad754e49bcbbd4be868fc6ac86034L843' target='_blank'>Link</a></div><div id='project'> Project Name: QUANTAXIS/QUANTAXIS</div><div id='commit'> Commit Name: 15ff4acfc4438dab85155acdf0b8fdb9e1292e0f</div><div id='time'> Time: 2017-08-02</div><div id='author'> Author: yutiansut@qq.com</div><div id='file'> File Name: QUANTAXIS/QABacktest/QABacktest.py</div><div id='class'> Class Name: QA_Backtest_stock_day</div><div id='method'> Method Name: __end_of_backtest</div><BR><BR><div id='link'><a href='https://github.com/QUANTAXIS/QUANTAXIS/commit/db55d91da808b441b8bcce0b8265f0d5d5179016#diff-5a5271825d5e9697c274452f32baefe85cc4bb1e2f57c1ae72afa014e3fd71a1L95' target='_blank'>Link</a></div><div id='project'> Project Name: QUANTAXIS/QUANTAXIS</div><div id='commit'> Commit Name: db55d91da808b441b8bcce0b8265f0d5d5179016</div><div id='time'> Time: 2017-05-01</div><div id='author'> Author: yutiansut@qq.com</div><div id='file'> File Name: test/test_strategy.py</div><div id='class'> Class Name: backtest</div><div id='method'> Method Name: handle_data</div><BR><BR><div id='link'><a href='https://github.com/QUANTAXIS/QUANTAXIS/commit/7245e2483baa57d12f6bb47de9c99be3c0ad8f3e#diff-ff318f3aaf648a4356f55f24bc50241310aad754e49bcbbd4be868fc6ac86034L528' target='_blank'>Link</a></div><div id='project'> Project Name: QUANTAXIS/QUANTAXIS</div><div id='commit'> Commit Name: 7245e2483baa57d12f6bb47de9c99be3c0ad8f3e</div><div id='time'> Time: 2017-11-22</div><div id='author'> Author: yutiansut@qq.com</div><div id='file'> File Name: QUANTAXIS/QABacktest/QABacktest.py</div><div id='class'> Class Name: QA_Backtest</div><div id='method'> Method Name: __end_of_backtest</div><BR>