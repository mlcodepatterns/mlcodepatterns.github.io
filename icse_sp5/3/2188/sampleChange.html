<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        self._optimizer = optimizer

        &#47&#47 Store the logit layer
        self._logit_layer = len(list(<a id="change">model.modules()</a>)) - 2 if use_logits else len(list(model.modules())) - 3

        &#47&#47 Use GPU if possible
        device = torch.device("cuda:0" if torch.cuda.is_available() else "cpu")</code></pre><h3>After Change</h3><pre><code class='java'>
        
        super(PyTorchClassifier, self).__init__(clip_values, defences)
        &#47&#47self._nb_classes = list(model.modules())[-1 if use_logits else -2].out_features
        self._nb_classes = <a id="change">output_shape[0]</a>
        self._input_shape = input_shape
        self._model = model
        self._loss = loss
        self._optimizer = optimizer</code></pre>